<!DOCTYPE html>
<!-- saved from url=(0102)http://ec2-52-13-12-96.us-west-2.compute.amazonaws.com/w6ghZyP7g/28d91cc9-df94-4892-9114-94b840a46d04# -->
<html class="gr__ec2-52-13-12-96_us-west-2_compute_amazonaws_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>CUDA Python - Click to Open</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://ec2-52-13-12-96.us-west-2.compute.amazonaws.com/w6ghZyP7g/static/base/images/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" href="./CUDA Python - Click to Open_files/jquery-ui.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./CUDA Python - Click to Open_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "http://cdn.mathjax.org/mathjax/latest/MathJax.js";
</script>

<link rel="stylesheet" href="./CUDA Python - Click to Open_files/codemirror.css">


    
	    
	        <link rel="stylesheet" href="./CUDA Python - Click to Open_files/style.min.css" type="text/css">
	    
    
    

<link rel="stylesheet" href="./CUDA Python - Click to Open_files/override.css" type="text/css">


    <link rel="stylesheet" href="./CUDA Python - Click to Open_files/custom.css" type="text/css">
    <script src="./CUDA Python - Click to Open_files/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          baseUrl: '/w6ghZyP7g/static/',
      });
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="components/marked/lib/marked" src="./CUDA Python - Click to Open_files/marked.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body data-project="/home/gpudev1/notebook" data-base-project-url="/w6ghZyP7g/" data-base-kernel-url="/w6ghZyP7g/" data-notebook-id="28d91cc9-df94-4892-9114-94b840a46d04" class="notebook_app"><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div>

<noscript>
    &lt;div id='noscript'&gt;
      IPython Notebook requires JavaScript.&lt;br&gt;
      Please enable it to proceed.
  &lt;/div&gt;
</noscript>

<div id="header" class="navbar navbar-static-top border-box-sizing" style="display: block;">
  <div class="navbar-inner navbar-nobg">
    <div class="container">
    <div id="ipython_notebook" class="nav brand pull-left"><a href="http://ec2-52-13-12-96.us-west-2.compute.amazonaws.com/w6ghZyP7g/" alt="dashboard"><img src="./CUDA Python - Click to Open_files/ipynblogo.png" alt="IPython Notebook"></a></div>

    

      <span id="login_widget">
        
      </span>

    

    

<span id="save_widget" class="nav pull-left">
    <span id="notebook_name">CUDA Python - Click to Open</span>
    <span id="checkpoint_status"></span>
    <span id="autosave_status">(autosaved)</span>
</span>


    </div>
  </div>
</div>

<div id="site" class="border-box-sizing" style="display: block;">


<div id="menubar-container" class="container">
<div id="menubar" class="border-box-sizing">
<div class="navbar">
  <div class="navbar-inner">
    <div class="container">
    <ul id="menus" class="nav">
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">File</a>
            <ul class="dropdown-menu">
                <li id="new_notebook"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">New</a></li>
                <li id="open_notebook"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Open...</a></li>
                <!-- <hr/> -->
                <li class="divider"></li>
                <li id="copy_notebook"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Make a Copy...</a></li>
                <li id="rename_notebook"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Rename...</a></li>
                <li id="save_checkpoint"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Save and Checkpoint</a></li>
                <!-- <hr/> -->
                <li class="divider"></li>
                <li id="restore_checkpoint" class="dropdown-submenu"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Revert to Checkpoint</a>
                  <ul class="dropdown-menu"><li class="disabled"><a>No checkpoints</a></li></ul>
                </li>
                <li class="divider"></li>
                <li class="dropdown-submenu"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Download as</a>
                    <ul class="dropdown-menu">
                        <li id="download_ipynb"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">IPython (.ipynb)</a></li>
                        <li id="download_py"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Python (.py)</a></li>
                    </ul>
                </li>
                <li class="divider"></li>
                
                <li id="kill_and_exit"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Close and halt</a></li>
            </ul>
        </li>
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
            <ul class="dropdown-menu">
                <li id="cut_cell"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Cut Cell</a></li>
                <li id="copy_cell"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Copy Cell</a></li>
                <li id="paste_cell_above" class="disabled"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Paste Cell Above</a></li>
                <li id="paste_cell_below" class="disabled"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Paste Cell Below</a></li>
                <li id="paste_cell_replace" class="disabled"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Paste Cell &amp; Replace</a></li>
                <li id="delete_cell"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Delete Cell</a></li>
                <li id="undelete_cell" class="disabled"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Undo Delete Cell</a></li>
                <li class="divider"></li>
                <li id="split_cell"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Split Cell</a></li>
                <li id="merge_cell_above"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Merge Cell Above</a></li>
                <li id="merge_cell_below"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Merge Cell Below</a></li>
                <li class="divider"></li>
                <li id="move_cell_up"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Move Cell Up</a></li>
                <li id="move_cell_down"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Move Cell Down</a></li>
                <li class="divider"></li>
                <li id="select_previous"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Select Previous Cell</a></li>
                <li id="select_next"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Select Next Cell</a></li>
            </ul>
        </li>
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">View</a>
            <ul class="dropdown-menu">
                <li id="toggle_header"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Toggle Header</a></li>
                <li id="toggle_toolbar"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Toggle Toolbar</a></li>
            </ul>
        </li>
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
            <ul class="dropdown-menu">
                <li id="insert_cell_above"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Insert Cell Above</a></li>
                <li id="insert_cell_below"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Insert Cell Below</a></li>
            </ul>
        </li>
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
            <ul class="dropdown-menu">
                <li id="run_cell"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Run</a></li>
                <li id="run_cell_in_place"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Run in Place</a></li>
                <li id="run_all_cells" title="Run all cells in the notebook"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Run All</a></li>
                <li id="run_all_cells_above" title="Run all cells above (but not including) this cell"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Run All Above</a></li>
                <li id="run_all_cells_below" title="Run this cell and all cells below it"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Run All Below</a></li>
                <li class="divider"></li>
                <li id="change_cell_type" class="dropdown-submenu"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Cell Type</a>
                    <ul class="dropdown-menu">
                      <li id="to_code"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Code</a></li>
                      <li id="to_markdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Markdown </a></li>
                      <li id="to_raw"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Raw Text</a></li>
                      <li id="to_heading1"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Heading 1</a></li>
                      <li id="to_heading2"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Heading 2</a></li>
                      <li id="to_heading3"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Heading 3</a></li>
                      <li id="to_heading4"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Heading 4</a></li>
                      <li id="to_heading5"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Heading 5</a></li>
                      <li id="to_heading6"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Heading 6</a></li>
                    </ul>
                </li>
                <li class="divider"></li>
                <li id="toggle_output"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Toggle Current Output</a></li>
                <li id="all_outputs" class="dropdown-submenu"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">All Output</a>
                    <ul class="dropdown-menu">
                        <li id="expand_all_output"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Expand</a></li>
                        <li id="scroll_all_output"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Scroll Long</a></li>
                        <li id="collapse_all_output"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Collapse</a></li>
                        <li id="clear_all_output"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Clear</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
            <ul class="dropdown-menu">
                <li id="int_kernel"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Interrupt</a></li>
                <li id="restart_kernel"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Restart</a></li>
            </ul>
        </li>
        <li class="dropdown"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="dropdown-toggle" data-toggle="dropdown">Help</a>
            <ul class="dropdown-menu">
                <li><a href="http://ipython.org/documentation.html" target="_blank">IPython Help</a></li>
                <li><a href="http://ipython.org/ipython-doc/stable/interactive/notebook.html" target="_blank">Notebook Help</a></li>
                <li id="keyboard_shortcuts"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html">Keyboard Shortcuts</a></li>
                <li class="divider"></li>
                <li><a href="http://docs.python.org/" target="_blank">Python</a></li>
                <li><a href="http://docs.scipy.org/doc/numpy/reference/" target="_blank">NumPy</a></li>
                <li><a href="http://docs.scipy.org/doc/scipy/reference/" target="_blank">SciPy</a></li>
                <li><a href="http://matplotlib.org/" target="_blank">Matplotlib</a></li>
                <li><a href="http://docs.sympy.org/dev/index.html" target="_blank">SymPy</a></li>
                <li><a href="http://pandas.pydata.org/pandas-docs/stable/" target="_blank">pandas</a></li>
            </ul>
        </li>
    </ul>
    <div id="notification_area"><div id="notification_kernel" class="notification_widget pull-right border-box-sizing" style="display: none;"></div><div id="notification_notebook" class="notification_widget pull-right border-box-sizing" style="display: none;"></div></div>
    </div>
  </div>
</div>
</div>
<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container border-box-sizing toolbar"><div class="btn-group"><button class="btn" title="Save and Checkpoint" id="save_b"><i class="icon-save"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn" title="Cut Cell" id="cut_b"><i class="icon-cut"></i></button><button class="btn" title="Copy Cell" id="copy_b"><i class="icon-copy"></i></button><button class="btn" title="Paste Cell Below" id="paste_b"><i class="icon-paste"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn" title="Move Cell Up" id="move_up_b"><i class="icon-arrow-up"></i></button><button class="btn" title="Move Cell Down" id="move_down_b"><i class="icon-arrow-down"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn" title="Insert Cell Above" id="insert_above_b"><i class="icon-circle-arrow-up"></i></button><button class="btn" title="Insert Cell Below" id="insert_below_b"><i class="icon-circle-arrow-down"></i></button></div><div class="btn-group" id="run_int"><button class="btn" title="Run Cell" id="run_b"><i class="icon-play"></i></button><button class="btn" title="Interrupt" id="interrupt_b"><i class="icon-stop"></i></button></div><select id="cell_type"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw Text</option><option value="heading1">Heading 1</option><option value="heading2">Heading 2</option><option value="heading3">Heading 3</option><option value="heading4">Heading 4</option><option value="heading5">Heading 5</option><option value="heading6">Heading 6</option></select><span class="navbar-text">Cell Toolbar:</span><select id="ctb_select"><option value="">None</option><option value="Default">Default</option><option value="Slideshow">Slideshow</option></select></div>
  </div>
</div>
</div>

<div id="ipython-main-app" class="border-box-sizing" style="height: 907px;">

    <div id="notebook_panel" class="border-box-sizing">
        <div id="notebook" class="border-box-sizing" style="height: 899px;"><div class="container" id="notebook-container"><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h1>Accelerating Python code with CUDA on GPUs</h1>
<p>In this self-paced, hands-on lab, we will use CUDA Python to accelerate code on NVIDIA GPUs.</p>
<p>Lab created by Mark Ebersole (Follow <a href="https://twitter.com/@cudahamster" target="_blank">@CUDAHamster</a> on Twitter)</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p>The following timer counts down to a five minute warning before the lab instance shuts down.  You should get a pop up at the five minute warning reminding you to save your work!</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><script src="./CUDA Python - Click to Open_files/countdown.js"></script>
<div id="clock" align="center"><div id="Stage_jbeeb_3" style="padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 100%; vertical-align: top; outline: 0px; -webkit-user-select: none; cursor: default; transform-origin: 0px 0px 0px; left: 0px; top: 0px; height: 60px; width: 150px; box-shadow: none; position: relative; display: block; clear: both; zoom: 1; overflow: visible; background-image: none; background-attachment: initial; background-origin: initial; background-clip: padding-box;"><div id="Container_jbeeb_6" style="position: absolute; overflow: visible; padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 100%; vertical-align: baseline; outline: 0px; -webkit-user-select: none; cursor: inherit; transform-origin: 0px 0px 0px; left: 3.75px; top: 0px; height: 41.25px; width: 67.5px; border-radius: 3.7125px; box-shadow: none; z-index: 0; background-image: -webkit-linear-gradient(top, rgb(0, 0, 0) 0%, rgb(104, 104, 104) 50%, rgb(0, 0, 0) 50%, rgb(83, 80, 80) 100%); background-attachment: initial; background-origin: initial; background-clip: padding-box;"><div id="TextBox_jbeeb_7" style="position: absolute; overflow: visible; padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 33px; vertical-align: baseline; outline: 0px; -webkit-user-select: none; cursor: inherit; transform-origin: 0px 0px 0px; left: 0px; top: 0px; height: 41.25px; width: 67.5px; box-shadow: none; white-space: nowrap; line-height: 1.25em; color: rgb(255, 255, 255); font-family: Arial, _sans; text-align: center; font-weight: normal; text-shadow: none; text-decoration: none; zoom: 1; z-index: 0; background-image: none; background-attachment: initial; background-origin: initial; background-clip: padding-box;"><span style="font-family: Arial, _sans;">40</span></div></div><div id="TextBox_jbeeb_8" style="position: absolute; overflow: visible; padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 13.125px; vertical-align: baseline; outline: 0px; -webkit-user-select: none; cursor: inherit; transform-origin: 0px 0px 0px; left: 0px; top: 46.875px; height: 13.125px; width: 75px; box-shadow: none; white-space: nowrap; line-height: 1em; color: rgb(48, 48, 48); font-family: Arial, _sans; text-align: center; font-weight: bold; text-shadow: none; text-decoration: none; zoom: 1; z-index: 1; background-image: none; background-attachment: initial; background-origin: initial; background-clip: padding-box;"><span style="font-family: Arial, _sans;">MINUTES</span></div><div id="Container_jbeeb_9" style="position: absolute; overflow: visible; padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 100%; vertical-align: baseline; outline: 0px; -webkit-user-select: none; cursor: inherit; transform-origin: 0px 0px 0px; left: 78.75px; top: 0px; height: 41.25px; width: 67.5px; border-radius: 3.7125px; box-shadow: none; z-index: 2; background-image: -webkit-linear-gradient(top, rgb(0, 0, 0) 0%, rgb(104, 104, 104) 50%, rgb(0, 0, 0) 50%, rgb(83, 80, 80) 100%); background-attachment: initial; background-origin: initial; background-clip: padding-box;"><div id="TextBox_jbeeb_10" style="position: absolute; overflow: visible; padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 33px; vertical-align: baseline; outline: 0px; -webkit-user-select: none; cursor: inherit; transform-origin: 0px 0px 0px; left: 0px; top: 0px; height: 41.25px; width: 67.5px; box-shadow: none; white-space: nowrap; line-height: 1.25em; color: rgb(255, 255, 255); font-family: Arial, _sans; text-align: center; font-weight: normal; text-shadow: none; text-decoration: none; zoom: 1; z-index: 0; background-image: none; background-attachment: initial; background-origin: initial; background-clip: padding-box;"><span style="font-family: Arial, _sans;">38</span></div></div><div id="TextBox_jbeeb_11" style="position: absolute; overflow: visible; padding: 0px; margin-right: 0px; margin-bottom: 0px; font-size: 13.125px; vertical-align: baseline; outline: 0px; -webkit-user-select: none; cursor: inherit; transform-origin: 0px 0px 0px; left: 75px; top: 46.875px; height: 13.125px; width: 75px; box-shadow: none; white-space: nowrap; line-height: 1em; color: rgb(48, 48, 48); font-family: Arial, _sans; text-align: center; font-weight: bold; text-shadow: none; text-decoration: none; zoom: 1; z-index: 3; background-image: none; background-attachment: initial; background-origin: initial; background-clip: padding-box;"><span style="font-family: Arial, _sans;">SECONDS</span></div></div></div>
<script>
myDate = new Date();
curTime = Date.UTC(myDate.getUTCFullYear(), 
                   myDate.getUTCMonth(), 
                   myDate.getUTCDate(), 
                   myDate.getUTCHours(), 
                   myDate.getUTCMinutes(),
                   myDate.getUTCSeconds(),
                   myDate.getUTCMilliseconds());

function countdownComplete(){
      alert("You only have five minutes left in the lab! Time to save your work - see the Post Lab section near the bottom.");
}
var myCD = new Countdown({
                         time      : (1452902766246+50*60000-curTime)/1000,
                         target         : "clock",
                         onComplete    : countdownComplete,
                         rangeHi  : "minute",
                         hideLine    : true,
                         hideLabels    : false,
                         height         : 60,
                         width     : 150,
                         style     : "boring",
                    });
 </script></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><hr>
<p>Before we begin, let's verify <a href="http://en.wikipedia.org/wiki/WebSocket" target="_blank">WebSockets</a> are working on your system.  To do this, execute the cell block below by giving it focus (clicking on it with your mouse), and hitting Ctrl-Enter, or pressing the play button in the toolbar above.  If all goes well, you should see get some output returned below the grey cell.  If not, please consult the <a href="https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting" target="_blank">Self-paced Lab Troubleshooting FAQ</a> to debug the issue.</p></div></div><div class="cell border-box-sizing code_cell" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[1]:</div><div class="vbox box-flex1"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.71143px; left: 374.531px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 402.358px; margin-left: 0px; min-height: 27.6665px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span class="cm-keyword">p</span><span class="cm-keyword">r</span><span class="cm-keyword">i</span><span class="cm-keyword">n</span><span class="cm-keyword">t</span><span> </span><span class="cm-string">"</span><span class="cm-string">T</span><span class="cm-string">h</span><span class="cm-string">e</span><span class="cm-string"> </span><span class="cm-string">a</span><span class="cm-string">n</span><span class="cm-string">s</span><span class="cm-string">w</span><span class="cm-string">e</span><span class="cm-string">r</span><span class="cm-string"> </span><span class="cm-string">s</span><span class="cm-string">h</span><span class="cm-string">o</span><span class="cm-string">u</span><span class="cm-string">l</span><span class="cm-string">d</span><span class="cm-string"> </span><span class="cm-string">b</span><span class="cm-string">e</span><span class="cm-string"> </span><span class="cm-string">t</span><span class="cm-string">h</span><span class="cm-string">r</span><span class="cm-string">e</span><span class="cm-string">e</span><span class="cm-string">:</span><span class="cm-string"> </span><span class="cm-string">"</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-builtin">s</span><span class="cm-builtin">t</span><span class="cm-builtin">r</span><span>(</span><span class="cm-number">1</span><span class="cm-operator">+</span><span class="cm-number">2</span><span>)</span></pre></div><div style="position: relative; z-index: 1; display: none;"></div><div class="CodeMirror-code"><pre><span class="cm-keyword">print</span> <span class="cm-string">"The answer should be three: "</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-number">1</span><span class="cm-operator">+</span><span class="cm-number">2</span>)</pre></div><div class="CodeMirror-cursor" style="left: 368.819px; top: 0px; height: 16.6665px;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 27.6665px;"></div><div class="CodeMirror-gutters" style="display: none; height: 28px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output vbox" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>The answer should be three: 3
</pre></div></div></div><div class="btn output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p>Let's execute the cell below to display information about the GPUs running on the server.</p></div></div><div class="cell border-box-sizing code_cell" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[2]:</div><div class="vbox box-flex1"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.71191px; left: 92.0313px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 119.441px; margin-left: 0px; min-height: 27.6665px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span class="cm-operator">!</span><span class="cm-variable">n</span><span class="cm-variable">v</span><span class="cm-variable">i</span><span class="cm-variable">d</span><span class="cm-variable">i</span><span class="cm-variable">a</span><span class="cm-operator">-</span><span class="cm-variable">s</span><span class="cm-variable">m</span><span class="cm-variable">i</span></pre></div><div style="position: relative; z-index: 1; display: none;"></div><div class="CodeMirror-code"><pre><span class="cm-operator">!</span><span class="cm-variable">nvidia</span><span class="cm-operator">-</span><span class="cm-variable">smi</span></pre></div><div class="CodeMirror-cursor" style="left: 86.3195px; top: 0px; height: 16.6665px;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 27.6665px;"></div><div class="CodeMirror-gutters" style="display: none; height: 28px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output vbox" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Sat Jan 16 00:07:15 2016       
+------------------------------------------------------+                       
| NVIDIA-SMI 340.29     Driver Version: 340.29         |                       
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  GRID K520           On   | 0000:00:03.0     Off |                  N/A |
| N/A   26C    P8    18W / 125W |     10MiB /  4095MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Compute processes:                                               GPU Memory |
|  GPU       PID  Process name                                     Usage      |
|=============================================================================|
|  No running compute processes found                                         |
+-----------------------------------------------------------------------------+
</pre></div></div></div><div class="btn output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><hr>
<p class="hint_trigger">If you have never before taken an IPython Notebook based self-paced lab from NVIDIA, click this green box.
      </p><div class="toggle_container" style="display: none;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">The following video will explain the infrastructure we are using for this self-paced lab, as well as give some tips on it's usage.  If you've never taken a lab on this system before, it's highly encourage you watch this short video first.
<div align="center"><iframe width="640" height="390" src="./CUDA Python - Click to Open_files/ZMrDaLSFqpY.html" frameborder="0" allowfullscreen=""></iframe></div>
</div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h2>Introduction to CUDA Python</h2>
<p>In this lab, we will learn how to write GPU code using Python, one of the fastest growing CUDA enabled languages.  By learning just a few new API calls, we'll be able to unlock the massively parallel capability of an NVIDIA GPU.</p>
<p>Watch the following short video introduction to Grids, Blocks, and Threads:<br><br></p>
<div align="center"><iframe width="640" height="390" src="./CUDA Python - Click to Open_files/KM-zbhyz9f4.html" frameborder="0" allowfullscreen=""></iframe></div>

<p>This lab consists of three tasks that will require you to modify some code and execute it.  For each task, a solution is provided so you can check your work or take a peek if you get lost.</p>
<p>If you are still confused now, or at any point in this lab, you can consult the <a href="http://ec2-52-13-12-96.us-west-2.compute.amazonaws.com/w6ghZyP7g/28d91cc9-df94-4892-9114-94b840a46d04#FAQ">FAQ</a> located at the bottom of this page.</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h2>Hello Parallelism</h2>
<p>For the first task, we are going to be using the following concepts:</p>
<ul>
<li><code style="color:green">@cuda.autojit</code> - this Python function decorator (goes on the line above a function definition) is used to tell the NumbaPro Python compiler that the function is to be compiled for the GPU, and is callable from both the host or the GPU itself.</li>
<li><code style="color:green">cuda.blockIdx.x</code> - this is a read-only variable that is defined for you.  It is used within a GPU kernel to determine the ID of the block which is currently executing code.  Since there will be many blocks running in parallel, we need this ID to help determine which chunk of data that particular block will work on.</li>
<li><code style="color:green">cuda.threadIdx.x</code> - this is a read-only variable that is defined for you.  It is used within a GPU kernel to determine the ID of the thread which is currently executing code in the active block.</li>
<li><code style="color:green">cuda.blockDim.x</code> - this is a read-only variable that is defined for you.  It simply returns a value indicating the number of threads there are per block.  Remember that all the blocks scheduled to execute on the GPU are identical, except for the <code style="color:green">cuda.blockIdx.x</code> value.</li>
<li><code style="color:green">myKernel [ number_of_blocks, threads_per_block ] (...)</code> -  this is the syntax used to launch a kernel on the GPU.  Inside the square brackets we set two values.  The first is the total number of blocks we want to run on the GPU, and the second is the number of threads there are per block.  It's possible, and in fact recommended, for one to schedule more blocks than the GPU can actively run in parallel.  In this case, the system will just continue executing blocks until they have all run.</li>
</ul>
<p>Let's explore the above concepts by doing a simple example.</p>
<p>There is nothing you need to do to the code to get this example to work.  Before you do anything else, select the next cell down and hit Ctrl-Enter (or the play button in the toolbar) to run the code.  If everything is working, you should see the following: <code>[ 0.]</code></p></div></div><div class="cell border-box-sizing code_cell" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[3]:</div><div class="vbox box-flex1"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 155.71px; left: 194.045px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 701.177px; margin-left: 0px; min-height: 277.664px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span> </span><span> </span><span> </span><span> </span><span class="cm-variable">n</span><span class="cm-variable">u</span><span class="cm-variable">m</span><span class="cm-variable">b</span><span class="cm-variable">e</span><span class="cm-variable">r</span><span class="cm-variable">_</span><span class="cm-variable">o</span><span class="cm-variable">f</span><span class="cm-variable">_</span><span class="cm-variable">b</span><span class="cm-variable">l</span><span class="cm-variable">o</span><span class="cm-variable">c</span><span class="cm-variable">k</span><span class="cm-variable">s</span><span> </span><span>=</span><span> </span><span class="cm-number">1</span></pre></div><div style="position: relative; z-index: 1; display: none;"></div><div class="CodeMirror-code"><pre><span class="cm-keyword">from</span> <span class="cm-variable">numbapro</span> <span class="cm-keyword">import</span> <span class="cm-variable">cuda</span> <span class="cm-comment"># Import the CUDA Runtime API</span></pre><pre><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span> <span class="cm-comment"># Import NumPy for creating data arrays</span></pre><pre>&nbsp;</pre><pre><span class="cm-meta">@cuda.autojit</span></pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">hello</span>(<span class="cm-variable">ary</span>):</pre><pre>    <span class="cm-variable">ary</span>[<span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">x</span>] = <span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">blockIdx</span>.<span class="cm-variable">x</span></pre><pre>    </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">main</span>():</pre><pre>    <span class="cm-variable">threads_per_block</span> = <span class="cm-number">1</span></pre><pre>    <span class="cm-variable">number_of_blocks</span> = <span class="cm-number">1</span></pre><pre>    <span class="cm-variable">ary</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty</span>(<span class="cm-variable">threads_per_block</span>) <span class="cm-comment"># Create an array of threads_per_block elements</span></pre><pre>    <span class="cm-variable">hello</span>[<span class="cm-variable">number_of_blocks</span>,<span class="cm-variable">threads_per_block</span>] (<span class="cm-variable">ary</span>)</pre><pre>    </pre><pre>    <span class="cm-keyword">print</span> <span class="cm-variable">ary</span> <span class="cm-comment"># Print out the values filled in by the GPU</span></pre><pre>    </pre><pre><span class="cm-variable">main</span>()</pre></div><div class="CodeMirror-cursor" style="left: 188.333px; top: 149.999px; height: 16.6665px; visibility: hidden;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none; visibility: hidden;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 277.664px;"></div><div class="CodeMirror-gutters" style="display: none; height: 278px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output vbox" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[ 0.]
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stderr"><pre>Vendor:  Continuum Analytics, Inc.
Package: mkl
Message: trial mode expires in 30 days
</pre></div></div></div><div class="btn output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Task #1</h3>
<p>Your first task in this lab is to play around with the number of blocks, and threads per block by modifying the values <code>threads_per_block</code> and <code>number_of_blocks</code>. To make these changes, simply click on the cell below this one and edit the code.</p>
<ul>
<li>What do you expect to see if you do <code>number_of_blocks = 2</code> and <code>threads_per_block = 1</code>?</li>
<li>What do you expect to see if you do <code>number_of_blocks = 100</code> and <code>threads_per_block = 5</code>?</li>
<li>Can you make the values arbitrarily large?</li>
</ul>
<p>After making a change, simply execute the cell with Ctrl-Enter and see the result.</p></div></div><div class="cell border-box-sizing code_cell" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[4]:</div><div class="vbox box-flex1"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.0449px; left: 5.71179px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 520.17px; margin-left: 0px; min-height: 277.667px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>​</span></pre></div><div style="position: relative; z-index: 1; display: none;"></div><div class="CodeMirror-code"><pre><span class="cm-keyword">from</span> <span class="cm-variable">numbapro</span> <span class="cm-keyword">import</span> <span class="cm-variable">cuda</span> <span class="cm-comment"># Import the CUDA Runtime API</span></pre><pre><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span> <span class="cm-comment"># Import NumPy for creating data arrays</span></pre><pre>&nbsp;</pre><pre><span class="cm-meta">@cuda.autojit</span></pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">hello</span>(<span class="cm-variable">ary</span>):</pre><pre>    <span class="cm-variable">ary</span>[<span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">x</span>] = <span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">blockIdx</span>.<span class="cm-variable">x</span></pre><pre>    </pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">main</span>():</pre><pre>    <span class="cm-variable">threads_per_block</span> = <span class="cm-number">1</span></pre><pre>    <span class="cm-variable">number_of_blocks</span> = <span class="cm-number">1</span></pre><pre>    <span class="cm-variable">ary</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty</span>(<span class="cm-variable">threads_per_block</span>)</pre><pre>    <span class="cm-variable">hello</span>[<span class="cm-variable">number_of_blocks</span>,<span class="cm-variable">threads_per_block</span>] (<span class="cm-variable">ary</span>)</pre><pre>    </pre><pre>    <span class="cm-keyword">print</span> <span class="cm-variable">ary</span> <span class="cm-comment"># Print out the values filled in by the GPU</span></pre><pre>    </pre><pre><span class="cm-variable">main</span>()</pre></div><div class="CodeMirror-cursor" style="left: 0px; top: 33.333px; height: 16.6665px; visibility: hidden;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none; visibility: hidden;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 277.667px;"></div><div class="CodeMirror-gutters" style="display: none; height: 278px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output vbox" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[ 0.]
</pre></div></div></div><div class="btn output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p>Congrats!  You have successfully modified and executed your first program on the GPU!</p>
<p>Besides just getting our hands dirty compiling and executing code on the GPU, task1 was meant to enforce a fundamental principle.  If you set the number of threads per block to 5 and the number of blocks to 100, you should have noticed the values printed at the end were not from the last block - some randomness started to creep in.  The reason for this is we're executing these blocks &amp; threads on a massively parallel GPU.  So there will be 100's if not 1000's of threads all executing simultaneously with respect to each other.  It's basically a race condition to see which block or threads got to write their values to our array first.</p>
<p>In a more realistic example, like we'll work on below, we need to ensure there is enough memory allocated to hold the results from all our threads.</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Task #2</h3>
<p>For our second task, we're going to be accelerating the ever popular SAXPY (<strong>S</strong>ingle-precision <strong>A</strong> times <strong>X</strong> <strong>P</strong>lus <strong>Y</strong>) function on the GPU using CUDA.</p>
<p>Unlike Task #1, you are going to have to do some of work yourself!  In this example, the <code>saxpy</code> function has already been moved to the GPU, but it expects three arrays, <code>a</code>, <code>b</code>, and, <code>c</code>, to be passed to it.  So we need to handle getting the three arrays to the GPU version of <code>saxpy</code>.</p>
<p>It is important to realize here that the GPU has it's own physical memory, just like the CPU uses system RAM for it's memory.  When executing code on the GPU, we have to ensure any data it needs is first copied across the PCI-Express bus to the GPU's memory before we launch the <code>saxpy</code> kernel.  For this task, we will manage the GPU memory with the following API calls (detailed documentation <a href="http://docs.continuum.io/numbapro/CUDAJit.html#memory-transfer" target="_blank">here</a>).  It should also be noted that CUDA Python makes heavy use of NumPy's N-dimensional array objects.  You do not need an understanding of NumPy to work on this lab, but if you're interested in reading more, you can start <a href="http://www.numpy.org/" target="_blank">here</a>.</p>
<ul>
<li><code>d_ary = cuda.to_device(ary)</code> - this API call is used to allocate and copy memory to the GPU.  After it completes successfully, d_ary will point to a copy of the NumPy array data on the GPU.</li>
<li><code>d_ary = cuda.device_array(number_of_elements)</code> - this API call creates an empty NumPy array on the GPU of size number_of_elements</li>
<li><code>d_ary.copy_to_host(ary)</code> - this API call will copy the data in d_ary which is on the GPU, to the NumPy array on the host</li>
</ul>
<p>You may have noticed in Task #1, the NumbaPro compiler was smart enough to handle transferring the <code>ary</code> data itself.  For this task, we'll be doing it manually so you are aware of how it's done.</p>
<p>In the cell below, your objective is to replace the <code>## FIXME: ... ##</code> sections of code. Using the above calls, move the data to the GPU before the <code>saxpy</code> function is called, as well as copy the resulting <code>c</code> array back.  </p>
<p>To make sure you are getting the correct answer, the program prints out the first 5 and last 5 elements of <code>c</code>.  If everything was done correctly, the values should all be <strong>5</strong>.  The cells to compile and execute the program are located below the editor.  If you get stuck, there are a number of hints provided - just click on the green box to see what they are.</p>
<p>Finally, you can click the green solution box below the code to check your work.</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #1
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">To figure out the number_of_blocks, we want to divide the number of elements we're processing, by the number of threads_per_block.</div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #2
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">A kernel running on the GPU (indicated with <code>@cuda.autojit</code>) decorator cannot use host arrays, so make sure you are passing the device arrays into the <code>saxpy</code> function.</div></div></div><p></p></div></div><div class="cell border-box-sizing code_cell" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[5]:</div><div class="vbox box-flex1"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 389.047px; left: 5.71179px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 661.958px; margin-left: 0px; min-height: 694.337px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>​</span></pre></div><div style="position: relative; z-index: 1; display: none;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 1061px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 663px; width: 220.063px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 1061px; height: 646px;"></div></div><div class="CodeMirror-code"><pre><span class="cm-keyword">from</span> <span class="cm-variable">numbapro</span> <span class="cm-keyword">import</span> <span class="cm-variable">cuda</span></pre><pre><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></pre><pre>&nbsp;</pre><pre><span class="cm-meta">@cuda.autojit</span></pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">saxpy</span>(<span class="cm-variable">a</span>, <span class="cm-variable">b</span>, <span class="cm-variable">c</span>):</pre><pre>    <span class="cm-comment"># Determine our unique global thread ID, so we know which element to process</span></pre><pre>    <span class="cm-variable">tid</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">blockIdx</span>.<span class="cm-variable">x</span> <span class="cm-operator">*</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">blockDim</span>.<span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">x</span>;</pre><pre>&nbsp;</pre><pre>    <span class="cm-keyword">if</span> ( <span class="cm-variable">tid</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">c</span>.<span class="cm-variable">size</span> ): <span class="cm-comment"># Make sure we don't do more work than we have data!</span></pre><pre>        <span class="cm-variable">c</span>[<span class="cm-variable">tid</span>] = <span class="cm-number">2</span> <span class="cm-operator">*</span> <span class="cm-variable">a</span>[<span class="cm-variable">tid</span>] <span class="cm-operator">+</span> <span class="cm-variable">b</span>[<span class="cm-variable">tid</span>];</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">main</span>():</pre><pre>    <span class="cm-variable">N</span> = <span class="cm-number">2048</span> <span class="cm-operator">*</span> <span class="cm-number">2048</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Allocate host memory arrays</span></pre><pre>    <span class="cm-variable">a</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty</span>(<span class="cm-variable">N</span>)</pre><pre>    <span class="cm-variable">b</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty</span>(<span class="cm-variable">N</span>)</pre><pre>    <span class="cm-variable">c</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty</span>(<span class="cm-variable">N</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Initialize host memory</span></pre><pre>    <span class="cm-variable">a</span>.<span class="cm-variable">fill</span>(<span class="cm-number">2</span>)</pre><pre>    <span class="cm-variable">b</span>.<span class="cm-variable">fill</span>(<span class="cm-number">1</span>)</pre><pre>    <span class="cm-variable">c</span>.<span class="cm-variable">fill</span>(<span class="cm-number">0</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Allocate and copy GPU/device memory</span></pre><pre>    <span class="cm-variable">d_a</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">to_device</span>(<span class="cm-variable">a</span>)</pre><pre>    <span class="cm-variable">d_b</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">to_device</span>(<span class="cm-variable">b</span>)</pre><pre>    <span class="cm-variable">d_c</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">to_device</span>(<span class="cm-variable">c</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">threads_per_block</span> = <span class="cm-number">128</span></pre><pre>    <span class="cm-variable">number_of_blocks</span> = <span class="cm-variable">N</span> <span class="cm-operator">/</span> <span class="cm-number">128</span> <span class="cm-operator">+</span> <span class="cm-number">1</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">saxpy</span> [ <span class="cm-variable">number_of_blocks</span>, <span class="cm-variable">threads_per_block</span> ] ( <span class="cm-variable">d_a</span>, <span class="cm-variable">d_b</span>, <span class="cm-variable">d_c</span> )</pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">d_c</span>.<span class="cm-variable">copy_to_host</span>(<span class="cm-variable">c</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Print out the first and last 5 values of c for a quality check</span></pre><pre>    <span class="cm-keyword">print</span> <span class="cm-variable">c</span>[:<span class="cm-number">5</span>]</pre><pre>    <span class="cm-keyword">print</span> <span class="cm-variable">c</span>[<span class="cm-operator">-</span><span class="cm-number">5</span>:]</pre><pre>&nbsp;</pre><pre><span class="cm-variable">main</span>() <span class="cm-comment"># Execute the program</span></pre></div><div class="CodeMirror-cursor" style="left: 0px; top: 383.335px; height: 16.6667px; visibility: hidden;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none; visibility: hidden;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 694.337px;"></div><div class="CodeMirror-gutters" style="display: none; height: 694.337px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output vbox" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[ 5.  5.  5.  5.  5.]
[ 5.  5.  5.  5.  5.]
</pre></div></div></div><div class="btn output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Click to check your solution
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;"><pre>from numbapro import cuda
import numpy as np

@cuda.autojit
def saxpy(a, b, c):
    # Determine our unique global thread ID, so we know which element to process
    tid = cuda.blockIdx.x * cuda.blockDim.x + cuda.threadIdx.x;

    if ( tid &lt; c.size ): # Make sure we don't do more work than we have data!
        c[tid] = 2 * a[tid] + b[tid];

def main():
    N = 2048 * 2048

    # Allocate host memory arrays
    a = np.empty(N)
    b = np.empty(N)
    c = np.empty(N)

    # Initialize host memory
    a.fill(2)
    b.fill(1)
    c.fill(0)

    # Allocate and copy GPU/device memory
    d_a = cuda.to_device(a)
    d_b = cuda.to_device(b)
    d_c = cuda.to_device(c)

    threads_per_block = 128
    number_of_blocks = N / 128 + 1

    saxpy [ number_of_blocks, threads_per_block ] ( d_a, d_b, d_c )

    d_c.copy_to_host(c)

    # Print out the first and last 5 values of c for a quality check
    print c[:5]
    print c[-5:]

main() # Execute the program</pre></div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p>The output of your program should be all 5's.  If you got this, you have successfully done the following:</p>
<ol>
<li>Allocated space in GPU memory</li>
<li>Copied data from the CPU to the GPU</li>
<li>Launched the <code>saxpy</code> function on the GPU</li>
<li>Copied the resulting data back to the CPU</li>
</ol>
<p>If you are still not able to get the correct output, please have a look at the solution hidden in the green box above and see if you can figure out what you were missing!</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h3>Task #3</h3>
<p>Your final task in this lab will be to accelerate a basic matrix multiplication function on the GPU.  In this simplified example, we'll assume our matrices are all square - they have the same number of rows and columns.</p>
<p>In this task, all the data movement has already been completed for you.  Your goal is to modify the <code>matrixMulGPU</code> function with CUDA so it will run on the GPU.  However, there is a new twist!  Instead of just using one-dimensional blocks of threads and blocks, we'll be using two dimensions; x and y.  In the <code>main</code> function of Task #3, these are set with the following:</p>
<pre><code>threads_per_block = (16, 16) # A 16 x 16 block threads
number_of_blocks = ((N / threads_per_block[0]) + 1, (N / threads_per_block[1]) + 1)</code></pre>
<p>So, in addition to using <code>cuda.blockIdx.x</code>, <code>cuda.blockDim.x</code>, and <code>cuda.threadIdx.x</code>, you'll also need to use <code>cuda.blockIdx.<span style="color:orange"><strong>y</strong></span></code>, <code>cuda.blockDim.<span style="color:orange"><strong>y</strong></span></code>, and <code>cuda.threadIdx.<span style="color:orange"><strong>y</strong></span></code>. As usual, please make use of the hints provided if you get stuck, and you can always check the green box below the code to see the answer.</p>
<p><strong>Note</strong>: do not modify the CPU version <code>matrixMulCPU</code>.  This is used to verify the results of the GPU version.</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #1
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">You only need to modify the <code>matrixMulGPU</code> function.  No other code needs to be modified for this task.</div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #2
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">You'll be using a single thread to calculate one element of the output matrix <code>c</code>.  Each thread will execute the inner-most loop of the matrix multiplication formula.</div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #3
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">The <code>row</code> value should be set to <code>cuda.blockIdx.x * cuda.blockDim.x + cuda.threadIdx.x</code> to get the thread which is calculating the row part of the <code>c</code> matrix.  Can you figure out what the <code>col</code> value should be set to?</div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #4
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">Don't forget the <code>@cuda.autojit</code> function decorator to tell the compiler that <code>matrixMulGPU</code> is now a GPU function!</div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Hint #5
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;">Just like the CPU version, we need to make sure we do not do more work than we have data.  In this example, the <code>main</code> function is actually launching <code>matrixMulGPU</code> with more blocks of threads than we have data.  Make sure you're doing a check in your modified code so that <code>row</code> <strong>and</strong> <code>col</code> are less than N.</div></div></div><p></p></div></div><div class="cell border-box-sizing code_cell" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="vbox box-flex1"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.0451px; left: 5.71179px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px;"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 716.646px; margin-left: 0px; min-height: 1211px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>​</span></pre></div><div style="position: relative; z-index: 1; display: none;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 1061px; height: 16.6667px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 1200px; width: 188.333px; height: 16.6667px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 16.6667px; width: 1061px; height: 1183.33px;"></div></div><div class="CodeMirror-code"><pre><span class="cm-keyword">from</span> <span class="cm-variable">numbapro</span> <span class="cm-keyword">import</span> <span class="cm-variable">cuda</span></pre><pre><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></pre><pre>&nbsp;</pre><pre><span class="cm-variable">N</span> = <span class="cm-number">64</span></pre><pre>&nbsp;</pre><pre><span class="cm-meta">@cuda.autojit</span></pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">matrixMulGPU</span>( <span class="cm-variable">a</span>, <span class="cm-variable">b</span>, <span class="cm-variable">c</span> ):</pre><pre>    <span class="cm-variable">val</span> = <span class="cm-number">0</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">row</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">blockIdx</span>.<span class="cm-variable">x</span> <span class="cm-operator">*</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">blockDim</span>.<span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">x</span></pre><pre>    <span class="cm-variable">col</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">blockIdx</span>.<span class="cm-variable">y</span> <span class="cm-operator">*</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">blockDim</span>.<span class="cm-variable">y</span> <span class="cm-operator">+</span> <span class="cm-variable">cuda</span>.<span class="cm-variable">threadIdx</span>.<span class="cm-variable">y</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-keyword">if</span> (<span class="cm-variable">row</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">N</span> <span class="cm-operator">and</span> <span class="cm-variable">col</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">N</span>):</pre><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">k</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>            <span class="cm-variable">val</span> += <span class="cm-variable">a</span>[<span class="cm-variable">row</span>,<span class="cm-variable">k</span>] <span class="cm-operator">*</span> <span class="cm-variable">b</span>[<span class="cm-variable">k</span>,<span class="cm-variable">col</span>]</pre><pre>        <span class="cm-variable">c</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] = <span class="cm-variable">val</span></pre><pre>&nbsp;</pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">matrixMulCPU</span>( <span class="cm-variable">a</span>, <span class="cm-variable">b</span>, <span class="cm-variable">c</span> ):</pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">row</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">col</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>            <span class="cm-variable">val</span> = <span class="cm-number">0</span></pre><pre>            <span class="cm-keyword">for</span> <span class="cm-variable">k</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>                <span class="cm-variable">val</span> += <span class="cm-variable">a</span>[<span class="cm-variable">row</span>,<span class="cm-variable">k</span>] <span class="cm-operator">*</span> <span class="cm-variable">b</span>[<span class="cm-variable">k</span>,<span class="cm-variable">col</span>]</pre><pre>            <span class="cm-variable">c</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] = <span class="cm-variable">val</span></pre><pre>&nbsp;</pre><pre><span class="cm-keyword">def</span> <span class="cm-variable">main</span>():</pre><pre>    <span class="cm-comment"># Allocate host memory</span></pre><pre>    <span class="cm-variable">a</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty</span>([<span class="cm-variable">N</span>,<span class="cm-variable">N</span>], <span class="cm-variable">dtype</span>=<span class="cm-variable">np</span>.<span class="cm-variable">float32</span>)</pre><pre>    <span class="cm-variable">b</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty_like</span>(<span class="cm-variable">a</span>)</pre><pre>    <span class="cm-variable">c_cpu</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty_like</span>(<span class="cm-variable">a</span>)</pre><pre>    <span class="cm-variable">c_gpu</span> = <span class="cm-variable">np</span>.<span class="cm-variable">empty_like</span>(<span class="cm-variable">a</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Initialize host memory</span></pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">row</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">col</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>            <span class="cm-variable">a</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] = <span class="cm-variable">row</span></pre><pre>            <span class="cm-variable">b</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] = <span class="cm-variable">col</span><span class="cm-operator">+</span><span class="cm-number">2</span></pre><pre>            <span class="cm-variable">c_cpu</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] = <span class="cm-number">0</span></pre><pre>            <span class="cm-variable">c_gpu</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] = <span class="cm-number">0</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Allocate and initialize GPU/device memory</span></pre><pre>    <span class="cm-variable">d_a</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">to_device</span>(<span class="cm-variable">a</span>)</pre><pre>    <span class="cm-variable">d_b</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">to_device</span>(<span class="cm-variable">b</span>)</pre><pre>    <span class="cm-variable">d_c</span> = <span class="cm-variable">cuda</span>.<span class="cm-variable">to_device</span>(<span class="cm-variable">c_gpu</span>) <span class="cm-comment"># since we're overwriting c on the GPU in </span></pre><pre>                                <span class="cm-comment"># the matrixMul kernel, no need to copy data over</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">threads_per_block</span> = (<span class="cm-number">16</span>, <span class="cm-number">16</span>) <span class="cm-comment"># A 16 x 16 block threads</span></pre><pre>    <span class="cm-variable">number_of_blocks</span> = ((<span class="cm-variable">N</span> <span class="cm-operator">/</span> <span class="cm-variable">threads_per_block</span>[<span class="cm-number">0</span>]) <span class="cm-operator">+</span> <span class="cm-number">1</span>, (<span class="cm-variable">N</span> <span class="cm-operator">/</span> <span class="cm-variable">threads_per_block</span>[<span class="cm-number">1</span>]) <span class="cm-operator">+</span> <span class="cm-number">1</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">matrixMulGPU</span> [ <span class="cm-variable">number_of_blocks</span>, <span class="cm-variable">threads_per_block</span> ] ( <span class="cm-variable">d_a</span>, <span class="cm-variable">d_b</span>, <span class="cm-variable">d_c</span> )</pre><pre>&nbsp;</pre><pre>    <span class="cm-variable">d_c</span>.<span class="cm-variable">copy_to_host</span>(<span class="cm-variable">c_gpu</span>)</pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Call the CPU version to check our work</span></pre><pre>    <span class="cm-variable">matrixMulCPU</span>( <span class="cm-variable">a</span>, <span class="cm-variable">b</span>, <span class="cm-variable">c_cpu</span> )</pre><pre>&nbsp;</pre><pre>    <span class="cm-comment"># Compare the two answers to make sure they are equal</span></pre><pre>    <span class="cm-variable">error</span> = <span class="cm-builtin">False</span></pre><pre>    <span class="cm-keyword">for</span> <span class="cm-variable">row</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">error</span>:</pre><pre>            <span class="cm-keyword">break</span></pre><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">col</span> <span class="cm-operator">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">N</span>):</pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">error</span>:</pre><pre>                <span class="cm-keyword">break</span></pre><pre>            <span class="cm-keyword">if</span> <span class="cm-variable">c_cpu</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>] <span class="cm-operator">!=</span> <span class="cm-variable">c_gpu</span>[<span class="cm-variable">row</span>,<span class="cm-variable">col</span>]:</pre><pre>                <span class="cm-keyword">print</span> <span class="cm-string">"FOUND ERROR at c["</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">row</span>) <span class="cm-operator">+</span> <span class="cm-string">","</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">col</span>) <span class="cm-operator">+</span> <span class="cm-string">"]"</span></pre><pre>                <span class="cm-variable">error</span> = <span class="cm-builtin">True</span></pre><pre>&nbsp;</pre><pre>    <span class="cm-keyword">if</span> <span class="cm-operator">not</span> <span class="cm-variable">error</span>:</pre><pre>        <span class="cm-keyword">print</span> <span class="cm-string">"Success!"</span></pre><pre>&nbsp;</pre><pre><span class="cm-variable">main</span>() <span class="cm-comment"># Run the program</span></pre></div><div class="CodeMirror-cursor" style="left: 0px; top: 33.3333px; height: 16.6667px;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 1211px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1211px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output vbox" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Success!
</pre></div></div></div><div class="btn output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell border-box-sizing selected" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p class="hint_trigger active">Click to check your solution
      </p><div class="toggle_container" style="display: block;"><div class="input_area box-flex1"><div class="\&quot;highlight\&quot;"><pre>from numbapro import cuda
import numpy as np

N = 64

@cuda.autojit
def matrixMulGPU( a, b, c ):
    val = 0

    row = cuda.blockIdx.x * cuda.blockDim.x + cuda.threadIdx.x
    col = cuda.blockIdx.y * cuda.blockDim.y + cuda.threadIdx.y

    if (row &lt; N and col &lt; N):
        for k in range(N):
            val += a[row,k] * b[k,col]
        c[row,col] = val

def matrixMulCPU( a, b, c ):
    for row in range(N):
        for col in range(N):
            val = 0
            for k in range(N):
                val += a[row,k] * b[k,col]
            c[row,col] = val

def main():
    # Allocate host memory
    a = np.empty([N,N], dtype=np.float32)
    b = np.empty_like(a)
    c_cpu = np.empty_like(a)
    c_gpu = np.empty_like(a)

    # Initialize host memory
    for row in range(N):
        for col in range(N):
            a[row,col] = row
            b[row,col] = col+2
            c_cpu[row,col] = 0
            c_gpu[row,col] = 0

    # Allocate and initialize GPU/device memory
    d_a = cuda.to_device(a)
    d_b = cuda.to_device(b)
    d_c = cuda.to_device(c_gpu) # since we're overwriting c on the GPU in 
                                # the matrixMul kernel, no need to copy data over<br>
    threads_per_block = (16, 16) # A 16 x 16 block threads
    number_of_blocks = ((N / threads_per_block[0]) + 1, (N / threads_per_block[1]) + 1)

    matrixMulGPU [ number_of_blocks, threads_per_block ] ( d_a, d_b, d_c )

    d_c.copy_to_host(c_gpu)

    # Call the CPU version to check our work
    matrixMulCPU( a, b, c_cpu )

    # Compare the two answers to make sure they are equal
    error = False
    for row in range(N):
        if error:
            break
        for col in range(N):
            if error:
                break
            if c_cpu[row,col] != c_gpu[row,col]:
                print "FOUND ERROR at c[" + str(row) + "," + str(col) + "]"
                error = True

    if not error:
        print "Success!"

main() # Run the program</pre></div></div></div><p></p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p>If you get Task #3 to run without any errors, you have successfully taken a serial function and moved it to a massively parallel version on the GPU!</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h2>Learn More</h2>
<p>If you are interested in learning more, you can use the following resources:</p>
<ul>
<li>Learn more at the <a href="https://developer.nvidia.com/category/zone/cuda-zone" target="_blank">CUDA Developer Zone</a>.</li>
<li>Install <a href="https://store.continuum.io/cshop/accelerate/" target="_blank">Anaconda Accelerate</a> from Continuum Analytics.  You can also watch the <a href="http://www.youtube.com/watch?v=jKV1m8APttU" target="_blank">CUDACast</a> on this process.</li>
<li>Take the fantastic online and <strong>free</strong> Udacity <a href="https://www.udacity.com/course/cs344" target="_blank">Intro to Parallel Programming</a> course which uses CUDA C.</li>
<li>Search or ask questions on <a href="http://stackoverflow.com/questions/tagged/cuda" target="_blank">Stackoverflow</a> using the cuda tag</li>
</ul></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p><a id="post-lab"></a></p>
<h2>Post-Lab</h2>
<p>Finally, don't forget to save your work from this lab before time runs out and the instance shuts down!!</p>
<ol>
<li>Save this IPython Notebook by going to <code>File -&gt; Download as -&gt; IPython (.ipynb)</code> at the top of this window</li>
</ol></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><h2><a id="FAQ"></a></h2>
<h1>Lab FAQ</h1>
<p>Q: I'm encountering issues executing the cells, or other technical problems?<br>
A: Please see <a href="https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting" target="_blank">this</a> infrastructure FAQ.</p></div></div><div class="cell text_cell border-box-sizing" tabindex="2"><div class="ctb_hideshow"><div class="celltoolbar hbox reverse"></div></div><div class="text_cell_input border-box-sizing" style="display: none;"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>x</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div></div><div class="text_cell_render border-box-sizing rendered_html" tabindex="-1"><p><style>
p.hint_trigger{
  margin-bottom:7px;
  margin-top:-5px;
  background:#64E84D;
}
.toggle_container{
  margin-bottom:0px;
}
.toggle_container p{
  margin:2px;
}
.toggle_container{
  background:#f0f0f0;
  clear: both;
  font-size:100%;
}
</style></p>
<script>
$("p.hint_trigger").click(function(){
   $(this).toggleClass("active").next().slideToggle("normal");
});

$(".toggle_container").hide();
</script></div></div><div class="end_space"></div></div></div>
        <div id="pager_splitter" class="ui-draggable border-box-sizing ui-widget ui-state-default" title="Click to Show/Hide pager area, drag to Resize"></div>
        <div id="pager" class="border-box-sizing" style="height: 362.8px;">
            <div id="pager_button_area">
            <a role="button" title="Open the pager in an external window" class="ui-button" style="position: absolute; right: 20px;"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button" style="position: absolute; right: 5px;"><span class="ui-icon ui-icon-close"></span></a></div>
            <div id="pager-container" class="container border-box-sizing"></div>
        </div>
    </div>

</div>
<div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press tab 2 times)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" role="button" class="ui-button" title="show the current docstring in pager (press tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="./CUDA Python - Click to Open_files/CUDA Python - Click to Open.html" role="button" class="ui-button" title="Tootip is not dismissed while typing for 10 seconds" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>



</div>

<script src="./CUDA Python - Click to Open_files/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/namespace.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/page.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/loginwidget.js" type="text/javascript" charset="utf-8"></script>




    


<script src="./CUDA Python - Click to Open_files/codemirror.js" charset="utf-8"></script>
<script type="text/javascript">
    CodeMirror.modeURL = "/w6ghZyP7g/static/components/codemirror/mode/%N/%N.js";
</script>
<script src="./CUDA Python - Click to Open_files/loadmode.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/multiplex.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/overlay.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/matchbrackets.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/comment.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/htmlmixed.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/xml.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/javascript.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/css.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/rst.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/markdown.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/gfm.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/python.js" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/codemirror-ipython.js" charset="utf-8"></script>

<script src="./CUDA Python - Click to Open_files/highlight.pack.js" charset="utf-8"></script>

<script src="./CUDA Python - Click to Open_files/date.format.js" charset="utf-8"></script>

<script src="./CUDA Python - Click to Open_files/events.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/utils.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/dialog.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/layoutmanager.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/mathjaxutils.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/outputarea.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/cell.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/celltoolbar.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/codecell.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/completer.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/textcell.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/kernel.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/savewidget.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/quickhelp.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/pager.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/menubar.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/toolbar.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/maintoolbar.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/notebook.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/notificationwidget.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/notificationarea.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/tooltip.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/config.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/main.js" type="text/javascript" charset="utf-8"></script>

<script src="./CUDA Python - Click to Open_files/contexthint.js" charset="utf-8"></script>

<script src="./CUDA Python - Click to Open_files/default.js" type="text/javascript" charset="utf-8"></script>
<script src="./CUDA Python - Click to Open_files/slideshow.js" type="text/javascript" charset="utf-8"></script>



<script src="./CUDA Python - Click to Open_files/custom.js" type="text/javascript" charset="utf-8"></script>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size1, monospace;"></div></div></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>