<!DOCTYPE html>
<!-- saved from url=(0118)http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Task-1: -->
<html class="gr__ec2-54-226-84-67_compute-1_amazonaws_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>Getting started with Torch7</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/base/images/favicon.ico?v=30780f272ab4aac64aa073a841546240">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./Getting started with Torch7_files/jquery-ui.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./Getting started with Torch7_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/9hhwyw8mMT9B/static/mathjax/MathJax.js";
</script>

<link rel="stylesheet" href="./Getting started with Torch7_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./Getting started with Torch7_files/codemirror.css">


    <link rel="stylesheet" href="./Getting started with Torch7_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./Getting started with Torch7_files/override.css" type="text/css">
<link rel="stylesheet" href="" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./Getting started with Torch7_files/custom.css" type="text/css">
    <script src="./Getting started with Torch7_files/promise.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./Getting started with Torch7_files/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20151226093713",
          
          baseUrl: '/9hhwyw8mMT9B/static/',
          paths: {
            nbextensions : '/9hhwyw8mMT9B/nbextensions',
            kernelspecs : '/9hhwyw8mMT9B/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            jqueryui: 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/term.js/src/term',
          },
          shim: {
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            jqueryui: {
              deps: ["jquery"],
              exports: "$"
            }
          }
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/namespace" src="./Getting started with Torch7_files/namespace.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="jquery" src="./Getting started with Torch7_files/jquery.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/notebook" src="./Getting started with Torch7_files/notebook.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./Getting started with Torch7_files/contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/config" src="./Getting started with Torch7_files/config.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/utils" src="./Getting started with Torch7_files/utils.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/page" src="./Getting started with Torch7_files/page.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/events" src="./Getting started with Torch7_files/events.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="auth/js/loginwidget" src="./Getting started with Torch7_files/loginwidget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/maintoolbar" src="./Getting started with Torch7_files/maintoolbar.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/pager" src="./Getting started with Torch7_files/pager.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/quickhelp" src="./Getting started with Torch7_files/quickhelp.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/menubar" src="./Getting started with Torch7_files/menubar.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/notificationarea" src="./Getting started with Torch7_files/notificationarea.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/savewidget" src="./Getting started with Torch7_files/savewidget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/actions" src="./Getting started with Torch7_files/actions.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/keyboardmanager" src="./Getting started with Torch7_files/keyboardmanager.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/kernelselector" src="./Getting started with Torch7_files/kernelselector.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/lib/codemirror" src="./Getting started with Torch7_files/codemirror.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/about" src="./Getting started with Torch7_files/about.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./Getting started with Torch7_files/custom.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/dialog" src="./Getting started with Torch7_files/dialog.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/cell" src="./Getting started with Torch7_files/cell.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/textcell" src="./Getting started with Torch7_files/textcell.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/codecell" src="./Getting started with Torch7_files/codecell.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="moment" src="./Getting started with Torch7_files/moment.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/sessions/session" src="./Getting started with Torch7_files/session.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbar" src="./Getting started with Torch7_files/celltoolbar.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="components/marked/lib/marked" src="./Getting started with Torch7_files/marked.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/runmode/runmode" src="./Getting started with Torch7_files/runmode.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/mathjaxutils" src="./Getting started with Torch7_files/mathjaxutils.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/keyboard" src="./Getting started with Torch7_files/keyboard.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/tooltip" src="./Getting started with Torch7_files/tooltip.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbarpresets/default" src="./Getting started with Torch7_files/default.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbarpresets/rawcell" src="./Getting started with Torch7_files/rawcell.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/celltoolbarpresets/slideshow" src="./Getting started with Torch7_files/slideshow.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/scrollmanager" src="./Getting started with Torch7_files/scrollmanager.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/meta" src="./Getting started with Torch7_files/meta.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/toolbar" src="./Getting started with Torch7_files/toolbar.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/tour" src="./Getting started with Torch7_files/tour.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/notificationarea" src="./Getting started with Torch7_files/notificationarea(1).js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/edit/matchbrackets" src="./Getting started with Torch7_files/matchbrackets.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/edit/closebrackets" src="./Getting started with Torch7_files/closebrackets.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/comment/comment" src="./Getting started with Torch7_files/comment.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/security" src="./Getting started with Torch7_files/security.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/gfm/gfm" src="./Getting started with Torch7_files/gfm.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/codemirror-ipythongfm" src="./Getting started with Torch7_files/codemirror-ipythongfm.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/outputarea" src="./Getting started with Torch7_files/outputarea.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/completer" src="./Getting started with Torch7_files/completer.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/python/python" src="./Getting started with Torch7_files/python.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/codemirror-ipython" src="./Getting started with Torch7_files/codemirror-ipython.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="jqueryui" src="./Getting started with Torch7_files/jquery-ui.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="bootstrap" src="./Getting started with Torch7_files/bootstrap.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/kernels/kernel" src="./Getting started with Torch7_files/kernel.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="underscore" src="./Getting started with Torch7_files/underscore-min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="base/js/notificationwidget" src="./Getting started with Torch7_files/notificationwidget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="components/google-caja/html-css-sanitizer-minified" src="./Getting started with Torch7_files/html-css-sanitizer-minified.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/markdown/markdown" src="./Getting started with Torch7_files/markdown.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/mode/overlay" src="./Getting started with Torch7_files/overlay.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/addon/mode/multiplex" src="./Getting started with Torch7_files/multiplex.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/stex/stex" src="./Getting started with Torch7_files/stex.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="notebook/js/contexthint" src="./Getting started with Torch7_files/contexthint.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="bootstraptour" src="./Getting started with Torch7_files/bootstrap-tour.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/kernels/comm" src="./Getting started with Torch7_files/comm.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/kernels/serialize" src="./Getting started with Torch7_files/serialize.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/init" src="./Getting started with Torch7_files/init.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/xml/xml" src="./Getting started with Torch7_files/xml.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/manager" src="./Getting started with Torch7_files/manager.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_link" src="./Getting started with Torch7_files/widget_link.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_bool" src="./Getting started with Torch7_files/widget_bool.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_button" src="./Getting started with Torch7_files/widget_button.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_box" src="./Getting started with Torch7_files/widget_box.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_float" src="./Getting started with Torch7_files/widget_float.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_image" src="./Getting started with Torch7_files/widget_image.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_int" src="./Getting started with Torch7_files/widget_int.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_output" src="./Getting started with Torch7_files/widget_output.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_selection" src="./Getting started with Torch7_files/widget_selection.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_selectioncontainer" src="./Getting started with Torch7_files/widget_selectioncontainer.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget_string" src="./Getting started with Torch7_files/widget_string.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="backbone" src="./Getting started with Torch7_files/backbone-min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="widgets/js/widget" src="./Getting started with Torch7_files/widget.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.5.3') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.5.3') format('woff'), url('http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/static/mathjax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.5.3') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="codemirror/mode/lua/lua" src="./Getting started with Torch7_files/lua.js"></script></head>

<body class="notebook_app command_mode" data-project="" data-base-url="/9hhwyw8mMT9B/" data-ws-url="" data-notebook-name="Getting%20started%20with%20Torch7.ipynb" data-notebook-path="Getting%20started%20with%20Torch7.ipynb"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    &lt;div id='noscript'&gt;
      IPython Notebook requires JavaScript.&lt;br&gt;
      Please enable it to proceed.
  &lt;/div&gt;
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/tree" title="dashboard"><img src="./Getting started with Torch7_files/logo.png" alt="Jupyter Notebook"></a></div>

  

  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Getting started with Torch7</span>
    <span class="checkpoint_status" title="Sat, Dec 26, 2015 10:40 AM">Last Checkpoint: 2 hours ago</span>
    <span class="autosave_status">(unsaved changes)</span>
</span>

<span id="kernel_logo_widget">
  <img class="current_kernel_logo" src="./Getting started with Torch7_files/logo-64x64.png" style="display: inline;">
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">iTorch</span>
              <i id="kernel_indicator_icon" class="kernel_busy_icon" title="Kernel Busy"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Command Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-itorch"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">iTorch</a></li><li class="divider"></li><li id="new-notebook-submenu-python2"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Saturday, December 26, 2015 10:40 AM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Download as</a>
                            <ul class="dropdown-menu">
                                <li id="download_ipynb"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">IPython Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Lua (txt)</a></li>
                                <li id="download_html"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">reST (.rst)</a></li>
                                <li id="download_pdf"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Cut Cell</a></li>
                        <li id="copy_cell"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Copy Cell</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Paste Cell Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Paste Cell Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Paste Cell &amp; Replace</a></li>
                        <li id="delete_cell"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Delete Cell</a></li>
                        <li id="undelete_cell" class="disabled"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Undo Delete Cell</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Edit Notebook Metadata</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the IPython Notebook logo and notebook title (above menu bar)">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Toggle Header</a></li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Toggle Toolbar</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Run</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Run and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Run and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Current Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Restart</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Reconnect</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Python 2</a></li><li id="kernel-submenu-itorch"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">iTorch</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                <i class="fa fa-external-link menu-icon pull-right"></i>
                                Notebook Help
                                </a></li>
                            
                                <li><a href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                <i class="fa fa-external-link menu-icon pull-right"></i>
                                Markdown
                                </a></li>
                            
                            
                        
                        <li class="divider"></li>
                        <li title="About IPython Notebook"><a id="notebook_about" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#">About</a></li>
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="ipython.save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="ipython.insert-cell-after"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cell" data-jupyter-action="ipython.cut-selected-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cell" data-jupyter-action="ipython.copy-selected-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cell below" data-jupyter-action="ipython.paste-cell-after"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cell up" data-jupyter-action="ipython.move-selected-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cell down" data-jupyter-action="ipython.move-selected-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="ipython.run-select-next"><i class="fa-play fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="ipython.interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart kernel" data-jupyter-action="ipython.restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option></select><div class="btn-group"><span class="navbar-text">Cell Toolbar:</span><select id="ctb_select" class="form-control select-xs"><option value="">None</option><option value="Edit Metadata">Edit Metadata</option><option value="Raw Cell Format">Raw Cell Format</option><option value="Slideshow">Slideshow</option></select></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="display: block; height: 723px;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">h1</span> <span class="cm-attribute">align</span>=<span class="cm-string">"center"</span><span class="cm-tag cm-bracket">&gt;</span>Getting started with Torch7<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">h1</span><span class="cm-tag cm-bracket">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(images/torch.jpg)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 align="center" id="Getting-started-with-Torch7">Getting started with Torch7<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Getting-started-with-Torch7"></a></h1>

<p><img src="./Getting started with Torch7_files/torch.jpg" alt=""></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">This lab was created by Alison B Lowndes</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>This lab was created by Alison B Lowndes</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">The following timer counts down to a five minute warning before the lab instance shuts down.  You should get a pop up at the five minute warning reminding you to save your work!  If you are about to run out of time, please see the <span class="cm-link">[Post-Lab]</span><span class="cm-string">(#Post-Lab-Summary)</span> section for saving this lab to view offline later.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The following timer counts down to a five minute warning before the lab instance shuts down.  You should get a pop up at the five minute warning reminding you to save your work!  If you are about to run out of time, please see the <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Post-Lab-Summary">Post-Lab</a> section for saving this lab to view offline later.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">iframe</span> <span class="cm-attribute">id</span>=<span class="cm-string">"timer"</span> <span class="cm-attribute">src</span>=<span class="cm-string">"timer/timer.html"</span> <span class="cm-attribute">width</span>=<span class="cm-string">"100%"</span> <span class="cm-attribute">height</span>=<span class="cm-string">"120px"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">iframe</span><span class="cm-tag cm-bracket">&gt;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><iframe id="timer" src="./Getting started with Torch7_files/timer.html" width="100%" height="120px"></iframe></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 93px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-hr">---</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Before we begin, let's verify <span class="cm-link">[WebSockets]</span><span class="cm-string">(http://en.wikipedia.org/wiki/WebSocket)</span> are working on your system.  To do this, execute the cell block below by giving it focus (clicking on it with your mouse), and hitting Ctrl-Enter, or pressing the play button in the toolbar above.  If all goes well, you should see some output returned below the grey cell.  If not, please consult the <span class="cm-link">[Self-paced Lab Troubleshooting FAQ]</span><span class="cm-string">(https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting)</span> to debug the issue.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 93px;"></div><div class="CodeMirror-gutters" style="display: none; height: 108px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><hr>
<p>Before we begin, let's verify <a href="http://en.wikipedia.org/wiki/WebSocket" target="_blank">WebSockets</a> are working on your system.  To do this, execute the cell block below by giving it focus (clicking on it with your mouse), and hitting Ctrl-Enter, or pressing the play button in the toolbar above.  If all goes well, you should see some output returned below the grey cell.  If not, please consult the <a href="https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting" target="_blank">Self-paced Lab Troubleshooting FAQ</a> to debug the issue.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 364.761px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> (<span class="cm-string">"The answer should be three: "</span> .. (<span class="cm-number">1</span>+<span class="cm-number">2</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[4]:</div><div class="output_subarea output_text output_result"><pre>The answer should be three: 3	
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Let's execute the cell below to display information about the GPUs running on the server.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Let's execute the cell below to display information about the GPUs running on the server.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[5]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 187.545px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">os.execute</span>(<span class="cm-string">"nvidia-smi"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[5]:</div><div class="output_subarea output_text output_result"><pre>Sat Dec 26 11:16:05 2015       
+------------------------------------------------------+                       
| NVIDIA-SMI 346.46     Driver Version: 346.46         |                       
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[5]:</div><div class="output_subarea output_text output_result"><pre>|   0  GRID K520           On   | 0000:00:03.0     Off |                  N/A |
| N/A   36C    P0    42W / 125W |    272MiB /  4095MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|=============================================================================|
|    0      3251    C   /home/ubuntu/torch/install/bin/qlua            193MiB |
|    0      3646    C   /home/ubuntu/torch/install/bin/qlua             65MiB |
+-----------------------------------------------------------------------------+
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[5]:</div><div class="output_subarea output_text output_result"><pre>true	exit	0	
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">The below cell will use Torch to give you similar information about the GPU in the system.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The below cell will use Torch to give you similar information about the GPU in the system.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 449.364px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">require</span> <span class="cm-string">'cutorch'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(  <span class="cm-variable">cutorch.getDeviceProperties</span>(<span class="cm-variable">cutorch.getDevice</span>()) )</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[6]:</div><div class="output_subarea output_text output_result"><pre>{
  computeMode : 0
  memPitch : 2147483647
  canMapHostMemory : 1
  warpSize : 32
  pciDeviceID : 3
  pciBusID : 0
  totalConstMem : 65536
  pciDomainID : 0
  integrated : 0
  deviceOverlap : 1
  maxThreadsPerBlock : 1024
  clockRate : 797000
  maxTexture1D : 65536
  minor : 0
  name : GRID K520
  freeGlobalMem : 4008546304
  maxTexture1DLinear : 134217728
  kernelExecTimeoutEnabled : 0
  sharedMemPerBlock : 49152
  major : 3
  totalGlobalMem : 4294770688
  regsPerBlock : 65536
  textureAlignment : 512
  multiProcessorCount : 8
}
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 30px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0909px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">##Please ensure you only execute one cell at a time.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 45px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Please-ensure-you-only-execute-one-cell-at-a-time.">Please ensure you only execute one cell at a time.<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Please-ensure-you-only-execute-one-cell-at-a-time."></a></h2>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 226px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0909px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Introduction</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">The goal of this hands-on lab is to allow you to quickly understand Torch and its neural networks package in order to train a neural network on a GPU. If you havent done the other classes in the Introduction to Deep Learning course, it may be more efficient to go through the other classes first then come back and try this one. All classes and material are available at <span class="cm-link">https://developer.nvidia.com/deep-learning-courses</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">As you execute cells below, you will know the lab is processing when you see a solid (filled) circle in the top-right of the page.</span></pre><pre class=""><span style="padding-right: 0.1px;">Otherwise, when it is idle, you will see the following: <span class="cm-tag">![]</span><span class="cm-string">(images/iTorch.jpg)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">If a cell is stalled, you can stop it with the stop button in the toolbar.</span></pre><pre class=""><span style="padding-right: 0.1px;">For troubleshooting, please see <span class="cm-link">[Self-paced Lab Troubleshooting FAQ]</span><span class="cm-string">(https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting)</span> to debug the issue.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 226px;"></div><div class="CodeMirror-gutters" style="display: none; height: 242px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Introduction">Introduction<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Introduction"></a></h2>
<p>The goal of this hands-on lab is to allow you to quickly understand Torch and its neural networks package in order to train a neural network on a GPU. If you havent done the other classes in the Introduction to Deep Learning course, it may be more efficient to go through the other classes first then come back and try this one. All classes and material are available at <a href="https://developer.nvidia.com/deep-learning-courses" target="_blank">https://developer.nvidia.com/deep-learning-courses</a></p>
<p>As you execute cells below, you will know the lab is processing when you see a solid (filled) circle in the top-right of the page.
Otherwise, when it is idle, you will see the following: <img src="./Getting started with Torch7_files/iTorch.jpg" alt="">
If a cell is stalled, you can stop it with the stop button in the toolbar.
For troubleshooting, please see <a href="https://developer.nvidia.com/self-paced-labs-faq#Troubleshooting" target="_blank">Self-paced Lab Troubleshooting FAQ</a> to debug the issue.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 30px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0909px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## What is Torch?</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 45px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="What-is-Torch?">What is Torch?<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#What-is-Torch?"></a></h2>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 796px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(images/torch.jpg)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Torch core features include:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* a powerful N-dimensional array or Tensor</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* lots of routines for indexing, slicing, transposing, ...</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* amazing interface to C, via LuaJIT</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* linear algebra routines</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* neural network, and energy-based models</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* numeric optimization routines</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* fast and efficient GPU support</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* fully embeddable, with ports to iOS, Android and FPGA backends</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Why Torch?**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">The goal of Torch is for maximum flexibility and speed in building your scientific algorithms while making the process extremely simple. Torch comes with a large ecosystem of community-driven packages in machine learning, computer vision, signal processing, parallel processing, image, video, audio and networking among others, and builds on top of the Lua community.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">At the heart of Torch are the popular neural network and optimization libraries which are simple to use, while having maximum flexibility in implementing complex neural network topologies. You can build arbitrary graphs of neural networks, and parallelize them over CPUs and GPUs in an efficient manner.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">See <span class="cm-link">http://torch.ch</span> and the Cheatsheet here <span class="cm-link">https://github.com/torch/torch7/wiki/Cheatsheet</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Torch started around 2000 with Facebooks Ronan Collobert the main developer. Torch 7 is the current version, the 4th (using odd numbers only 1,3,5,7) aimed at web-scale learning in speech, image and video applications. Torch is used exclusively for research and prototyping for unsupervised and supervised learning, reinforcement learning, etc. Facebook, especially, spends a great deal of time improving parallelism for multi-GPU (model, data, DAG) and overlapping to improve host-device comms, as well as development in kernel speed for convolutions etc. Torch uses <span class="cm-strong">**automatic differentiation**</span>. This is not numerical differentiation but a technique to take exact derivatives without needing symbolic differentation.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**Maintainers**</span>: </span></pre><pre class=""><span style="padding-right: 0.1px;">* Ronan Collobert, Research Scientist @ Facebook</span></pre><pre class=""><span style="padding-right: 0.1px;">* Clement Farabet, Senior Software Engineer @ Twitter</span></pre><pre class=""><span style="padding-right: 0.1px;">* Koray Kavukcuoglu, Research Scientist @ Google DeepMind</span></pre><pre class=""><span style="padding-right: 0.1px;">* Soumith Chintala, Research Engineer @ Facebook</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Torch is already used in many companies and research labs including:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Facebook AI Research</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Google + Deepmind</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Twitter</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* CILVR @ NYU</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Idiap Research Institute</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* e-Lab @ Purdue</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Element Inc</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* WhetLab</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 796px;"></div><div class="CodeMirror-gutters" style="display: none; height: 812px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><img src="./Getting started with Torch7_files/torch.jpg" alt=""></p>
<p>Torch core features include:</p>
<ul>
<li>a powerful N-dimensional array or Tensor</li>
<li>lots of routines for indexing, slicing, transposing, ...</li>
<li>amazing interface to C, via LuaJIT</li>
<li>linear algebra routines</li>
<li>neural network, and energy-based models</li>
<li>numeric optimization routines</li>
<li>fast and efficient GPU support</li>
<li>fully embeddable, with ports to iOS, Android and FPGA backends</li>
</ul>
<p><strong>Why Torch?</strong>
The goal of Torch is for maximum flexibility and speed in building your scientific algorithms while making the process extremely simple. Torch comes with a large ecosystem of community-driven packages in machine learning, computer vision, signal processing, parallel processing, image, video, audio and networking among others, and builds on top of the Lua community.</p>
<p>At the heart of Torch are the popular neural network and optimization libraries which are simple to use, while having maximum flexibility in implementing complex neural network topologies. You can build arbitrary graphs of neural networks, and parallelize them over CPUs and GPUs in an efficient manner.</p>
<p>See <a href="http://torch.ch/" target="_blank">http://torch.ch</a> and the Cheatsheet here <a href="https://github.com/torch/torch7/wiki/Cheatsheet" target="_blank">https://github.com/torch/torch7/wiki/Cheatsheet</a></p>
<p>Torch started around 2000 with Facebooks Ronan Collobert the main developer. Torch 7 is the current version, the 4th (using odd numbers only 1,3,5,7) aimed at web-scale learning in speech, image and video applications. Torch is used exclusively for research and prototyping for unsupervised and supervised learning, reinforcement learning, etc. Facebook, especially, spends a great deal of time improving parallelism for multi-GPU (model, data, DAG) and overlapping to improve host-device comms, as well as development in kernel speed for convolutions etc. Torch uses <strong>automatic differentiation</strong>. This is not numerical differentiation but a technique to take exact derivatives without needing symbolic differentation.</p>
<p><strong>Maintainers</strong>: </p>
<ul>
<li>Ronan Collobert, Research Scientist @ Facebook</li>
<li>Clement Farabet, Senior Software Engineer @ Twitter</li>
<li>Koray Kavukcuoglu, Research Scientist @ Google DeepMind</li>
<li>Soumith Chintala, Research Engineer @ Facebook</li>
</ul>
<p>Torch is already used in many companies and research labs including:</p>
<ul>
<li>Facebook AI Research</li>
<li>Google + Deepmind</li>
<li>Twitter</li>
<li>CILVR @ NYU</li>
<li>Idiap Research Institute</li>
<li>e-Lab @ Purdue</li>
<li>Element Inc</li>
<li>WhetLab</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 224px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">The Torch core consists of the following packages:</span></pre><pre class=""><span style="padding-right: 0.1px;">* torch : tensors, class factory, serialization, BLAS </span></pre><pre class=""><span style="padding-right: 0.1px;">* nn : neural network Modules and Criterions</span></pre><pre class=""><span style="padding-right: 0.1px;">* optim : SGD, LBFGS and other optimization functions </span></pre><pre class=""><span style="padding-right: 0.1px;">* gnuplot : ploting and data visualization </span></pre><pre class=""><span style="padding-right: 0.1px;">* paths : make directories, concatenate file paths, and other filesystem utilities</span></pre><pre class=""><span style="padding-right: 0.1px;">* image : save, load, crop, scale, warp, translate images and such </span></pre><pre class=""><span style="padding-right: 0.1px;">* trepl : the torch LuaJIT interpreter </span></pre><pre class=""><span style="padding-right: 0.1px;">* cwrap : used for wrapping C/CUDA functions in Lua </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">[LBFGS = Limited memory BroydenFletcherGoldfarbShanno - an iterative method for solving unconstrained nonlinear optimization problems, approx. Newtons method].</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 224px;"></div><div class="CodeMirror-gutters" style="display: none; height: 239px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The Torch core consists of the following packages:</p>
<ul>
<li>torch : tensors, class factory, serialization, BLAS </li>
<li>nn : neural network Modules and Criterions</li>
<li>optim : SGD, LBFGS and other optimization functions </li>
<li>gnuplot : ploting and data visualization </li>
<li>paths : make directories, concatenate file paths, and other filesystem utilities</li>
<li>image : save, load, crop, scale, warp, translate images and such </li>
<li>trepl : the torch LuaJIT interpreter </li>
<li>cwrap : used for wrapping C/CUDA functions in Lua </li>
</ul>
<p>[LBFGS = Limited memory BroydenFletcherGoldfarbShanno - an iterative method for solving unconstrained nonlinear optimization problems, approx. Newtons method].</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 343px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0908px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Lua (JIT) </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Lua is a powerful, fast, lightweight, embeddable scripting language combining simple procedural syntax with powerful data description constructs based on associative arrays and extensible semantics. Lua is dynamically typed, runs by interpreting bytecode for a register-based virtual machine, and has automatic memory management with incremental garbage collection, making it ideal for configuration, scripting, and rapid prototyping. The language is maintained by a team at PUC-Rio, the Pontifical Catholic University of Rio de Janeiro in Brazil. Lua was born and raised in Tecgraf, formerly the Computer Graphics Technology Group of PUC-Rio. Lua is now housed at LabLua, a laboratory of the Department of Computer Science of PUC-Rio.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">###Just In Time compilation</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Using LuaJIT allows for complex applications to be compiled and optimized but also embedded into any environment (iPhone, video games, web backends). The complete Torch framework runs on iPhone, with no mods to scripts. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Torchs universal data structure, the table, can be used as an array, a dictionary, hash table, class, struct, object, list. Torch 7 extends the table with a Tensor object, an n-dim array type.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For training neural nets, autoencoders, linear regression, CNN's, RNNs etc its all about gradients and loss functions. Torchs nn package provides it all. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Recasting a pre-defined model as a CUDA model for use on GPUs is as simple as: <span class="cm-link">model:cuda()</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 343px;"></div><div class="CodeMirror-gutters" style="display: none; height: 358px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Lua-(JIT)">Lua (JIT)<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Lua-(JIT)"></a></h2>
<p>Lua is a powerful, fast, lightweight, embeddable scripting language combining simple procedural syntax with powerful data description constructs based on associative arrays and extensible semantics. Lua is dynamically typed, runs by interpreting bytecode for a register-based virtual machine, and has automatic memory management with incremental garbage collection, making it ideal for configuration, scripting, and rapid prototyping. The language is maintained by a team at PUC-Rio, the Pontifical Catholic University of Rio de Janeiro in Brazil. Lua was born and raised in Tecgraf, formerly the Computer Graphics Technology Group of PUC-Rio. Lua is now housed at LabLua, a laboratory of the Department of Computer Science of PUC-Rio.</p>
<h3 id="Just-In-Time-compilation">Just In Time compilation<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Just-In-Time-compilation"></a></h3>
<p>Using LuaJIT allows for complex applications to be compiled and optimized but also embedded into any environment (iPhone, video games, web backends). The complete Torch framework runs on iPhone, with no mods to scripts. </p>
<p>Torchs universal data structure, the table, can be used as an array, a dictionary, hash table, class, struct, object, list. Torch 7 extends the table with a Tensor object, an n-dim array type.</p>
<p>For training neural nets, autoencoders, linear regression, CNN's, RNNs etc its all about gradients and loss functions. Torchs nn package provides it all. </p>
<p>Recasting a pre-defined model as a CUDA model for use on GPUs is as simple as: model:cuda()</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59644px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 210px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0908px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">##LuaRocks</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Lua itself comes with a very handy manager: luarocks. </span></pre><pre class=""><span style="padding-right: 0.1px;">Different demos/tutorials rely on different 3rd-party packages. If a demo crashes because it can't find a package then simply try to install it using luarocks, eg:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-delimit">$</span> luarocks install image &nbsp;  (an image library for Torch7)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-delimit">$</span><span class="cm-comment"> luarocks install nnx &nbsp; &nbsp;  (lots of extra neural-net modules)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">```</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">There are many many packages (or rocks) managed by LuaRocks.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 210px;"></div><div class="CodeMirror-gutters" style="display: none; height: 225px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="LuaRocks">LuaRocks<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#LuaRocks"></a></h2>
<p>Lua itself comes with a very handy manager: luarocks. 
Different demos/tutorials rely on different 3rd-party packages. If a demo crashes because it can't find a package then simply try to install it using luarocks, eg:</p>
<pre><code>$ luarocks install image    (an image library for Torch7)
$ luarocks install nnx      (lots of extra neural-net modules)
</code></pre><p>There are many many packages (or rocks) managed by LuaRocks.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 30px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0908px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Before We Start</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 45px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Before-We-Start">Before We Start<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Before-We-Start"></a></h2>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59644px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">In order to deep learn we need data.  For the first part of this lab, w'll use the CIFAR10 dataset which is large enough to be useful, but small enough to train in a reasonable amount of time.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>In order to deep learn we need data.  For the first part of this lab, w'll use the CIFAR10 dataset which is large enough to be useful, but small enough to train in a reasonable amount of time.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 29px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.1819px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Tensors</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 29px;"></div><div class="CodeMirror-gutters" style="display: none; height: 45px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Tensors">Tensors<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Tensors"></a></h3>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59644px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 469px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">The Tensor class is the most important class in Torch. Almost every package depends on this class - for handling numeric data. A Tensor is a serializable, potentially multi-dimensional matrix. The number of dimensions is unlimited that can be created using LongStorage.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">####Internal data representation</span></span></pre><pre class=""><span style="padding-right: 0.1px;">The actual data of a Tensor is contained in a Storage. </span></pre><pre class=""><span style="padding-right: 0.1px;">'Storages' are how Lua accesses memory of a C pointer or array. </span></pre><pre class=""><span style="padding-right: 0.1px;">Storages can also map the contents of a file to memory. </span></pre><pre class=""><span style="padding-right: 0.1px;">A Storage is an array of basic C types. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Several types of Tensor exists:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* ByteTensor -- contains unsigned chars</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* CharTensor -- contains signed chars</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* ShortTensor -- contains shorts</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* IntTensor -- contains ints</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* FloatTensor -- contains floats</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* DoubleTensor -- contains doubles</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Several Storage classes for all the basic C types exist and have the following self-explanatory names: ByteStorage, CharStorage, ShortStorage, IntStorage, LongStorage, FloatStorage, DoubleStorage. ByteStorage and CharStorage represent both arrays of bytes. </span></pre><pre class=""><span style="padding-right: 0.1px;">ByteStorage represents an array of unsigned chars, while CharStorage represents an array of signed chars.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**One could say that a Tensor is a particular way of viewing a Storage: a Storage only represents a chunk of memory, while the Tensor interprets this chunk of memory as having dimensions.**</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Let's work through some basic Torch syntax.  Execute the cells below in order and make sure you understand the output.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 469px;"></div><div class="CodeMirror-gutters" style="display: none; height: 485px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The Tensor class is the most important class in Torch. Almost every package depends on this class - for handling numeric data. A Tensor is a serializable, potentially multi-dimensional matrix. The number of dimensions is unlimited that can be created using LongStorage.</p>
<h4 id="Internal-data-representation">Internal data representation<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Internal-data-representation"></a></h4>
<p>The actual data of a Tensor is contained in a Storage. 
'Storages' are how Lua accesses memory of a C pointer or array. 
Storages can also map the contents of a file to memory. 
A Storage is an array of basic C types. </p>
<p>Several types of Tensor exists:</p>
<ul>
<li>ByteTensor -- contains unsigned chars</li>
<li>CharTensor -- contains signed chars</li>
<li>ShortTensor -- contains shorts</li>
<li>IntTensor -- contains ints</li>
<li>FloatTensor -- contains floats</li>
<li>DoubleTensor -- contains doubles</li>
</ul>
<p>Several Storage classes for all the basic C types exist and have the following self-explanatory names: ByteStorage, CharStorage, ShortStorage, IntStorage, LongStorage, FloatStorage, DoubleStorage. ByteStorage and CharStorage represent both arrays of bytes. 
ByteStorage represents an array of unsigned chars, while CharStorage represents an array of signed chars.</p>
<p><strong>One could say that a Tensor is a particular way of viewing a Storage: a Storage only represents a chunk of memory, while the Tensor interprets this chunk of memory as having dimensions.</strong></p>
<p>Let's work through some basic Torch syntax.  Execute the cells below in order and make sure you understand the output.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 480.216px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> = <span class="cm-variable">torch.Tensor</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>) <span class="cm-comment">-- construct a 5x3 matrix, uninitialized</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 511.011px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> = <span class="cm-variable">torch.rand</span>(<span class="cm-number">5</span>,<span class="cm-number">3</span>) <span class="cm-comment">-- construct a 5x3 matrix with randomized data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">a</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[8]:</div><div class="output_subarea output_text output_result"><pre> 0.0659  0.9418  0.1302
 0.3330  0.1341  0.9294
 0.6954  0.0486  0.7588
 0.0506  0.8498  0.3597
 0.9882  0.3934  0.2650
[torch.DoubleTensor of size 5x3]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 133.852px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span>=<span class="cm-variable">torch.rand</span>(<span class="cm-number">3</span>,<span class="cm-number">4</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 318.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- matrix-matrix multiplication: syntax 1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span>*<span class="cm-variable">b</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[10]:</div><div class="output_subarea output_text output_result"><pre> 1.0345  0.9655  0.0887  0.3926
 0.7447  0.9010  0.4564  0.3322
 0.8149  0.9568  0.5768  0.3028
 1.0324  1.0125  0.1520  0.4156
 1.1297  1.1566  0.5688  0.3414
[torch.DoubleTensor of size 5x4]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[11]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 318.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- matrix-matrix multiplication: syntax 2</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">torch.mm</span>(<span class="cm-variable">a</span>,<span class="cm-variable">b</span>) </span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[11]:</div><div class="output_subarea output_text output_result"><pre> 1.0345  0.9655  0.0887  0.3926
 0.7447  0.9010  0.4564  0.3322
 0.8149  0.9568  0.5768  0.3028
 1.0324  1.0125  0.1520  0.4156
 1.1297  1.1566  0.5688  0.3414
[torch.DoubleTensor of size 5x4]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[12]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 318.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- matrix-matrix multiplication: syntax 3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>=<span class="cm-variable">torch.Tensor</span>(<span class="cm-number">5</span>,<span class="cm-number">4</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>:<span class="cm-variable">mm</span>(<span class="cm-variable">a</span>,<span class="cm-variable">b</span>) <span class="cm-comment">-- store the result of a*b in c</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">c</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[12]:</div><div class="output_subarea output_text output_result"><pre> 1.0345  0.9655  0.0887  0.3926
 0.7447  0.9010  0.4564  0.3322
 0.8149  0.9568  0.5768  0.3028
 1.0324  1.0125  0.1520  0.4156
 1.1297  1.1566  0.5688  0.3414
[torch.DoubleTensor of size 5x4]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59619px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 29px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.1816px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">###CUDA Tensors</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 29px;"></div><div class="CodeMirror-gutters" style="display: none; height: 45px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="CUDA-Tensors">CUDA Tensors<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#CUDA-Tensors"></a></h3>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Tensors can be moved onto GPU using the :cuda function</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Tensors can be moved onto GPU using the :cuda function</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[13]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59619px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 187.545px; margin-bottom: -15px; border-right-width: 15px; min-height: 109px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">require</span> <span class="cm-string">'cutorch'</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">a</span> = <span class="cm-variable">a</span>:<span class="cm-variable">cuda</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">b</span> = <span class="cm-variable">b</span>:<span class="cm-variable">cuda</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span> = <span class="cm-variable">c</span>:<span class="cm-variable">cuda</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">c</span>:<span class="cm-variable">mm</span>(<span class="cm-variable">a</span>,<span class="cm-variable">b</span>) <span class="cm-comment">-- done on GPU</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">c</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 109px;"></div><div class="CodeMirror-gutters" style="display: none; height: 125px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[13]:</div><div class="output_subarea output_text output_result"><pre> 1.0345  0.9655  0.0887  0.3926
 0.7447  0.9010  0.4564  0.3322
 0.8149  0.9568  0.5768  0.3028
 1.0324  1.0125  0.1520  0.4156
 1.1297  1.1566  0.5688  0.3414
[torch.CudaTensor of size 5x4]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">To run neural networks on GPUs we use cunn: <span class="cm-strong">**not to be confused with cudnn**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">The nn module provides modules which each contain their state, and these modules expect CudaTensors as inputs. </span></pre><pre class=""><span style="padding-right: 0.1px;">To use Cuda-based nn modules, you will need to import cunn:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>To run neural networks on GPUs we use cunn: <strong>not to be confused with cudnn</strong>
The nn module provides modules which each contain their state, and these modules expect CudaTensors as inputs. 
To use Cuda-based nn modules, you will need to import cunn:</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59619px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 118.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">require</span> <span class="cm-string">'cunn'</span>;</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 177px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0908px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## CUDA</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">To use GPU's with torch you call <span class="cm-delimit">$</span> require "cutorch" on a CUDA-capable machine. </span></pre><pre class=""><span style="padding-right: 0.1px;">Here's an explanation of the packages needed for using Torch with GPUs:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">* cutorch - Torch CUDA Implementation</span></pre><pre class=""><span style="padding-right: 0.1px;">* cunn - Torch CUDA Neural Network Implementation</span></pre><pre class=""><span style="padding-right: 0.1px;">* cunnx - Experimental CUDA NN implementations</span></pre><pre class=""><span style="padding-right: 0.1px;">* cudnn - NVIDIA CuDNN Bindings</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 177px;"></div><div class="CodeMirror-gutters" style="display: none; height: 193px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="CUDA">CUDA<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#CUDA"></a></h2>
<p>To use GPU's with torch you call $ require "cutorch" on a CUDA-capable machine. 
Here's an explanation of the packages needed for using Torch with GPUs:</p>
<ul>
<li>cutorch - Torch CUDA Implementation</li>
<li>cunn - Torch CUDA Neural Network Implementation</li>
<li>cunnx - Experimental CUDA NN implementations</li>
<li>cudnn - NVIDIA CuDNN Bindings</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 46px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0908px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Neural Networks</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Neural networks in Torch can be constructed using the nn package.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 62px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Neural-Networks">Neural Networks<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Neural-Networks"></a></h2>
<p>Neural networks in Torch can be constructed using the nn package.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 191px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Modules are the bricks used to build neural networks. Each are themselves neural networks, but can be combined with other networks using containers to create more complex neural networks.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For example, LeNet, is a network that classfies digit images, a simple feed-forward network.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(images/lenet.jpg)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">It takes the input, feeds it through several layers one after the other, and then finally gives the output.</span></pre><pre class=""><span style="padding-right: 0.1px;">Such a network container is <span class="cm-comment">`nn.Sequential`</span> which feeds the input through several layers.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Let's use Torch to create a LeNet network in the cell below.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 191px;"></div><div class="CodeMirror-gutters" style="display: none; height: 206px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Modules are the bricks used to build neural networks. Each are themselves neural networks, but can be combined with other networks using containers to create more complex neural networks.</p>
<p>For example, LeNet, is a network that classfies digit images, a simple feed-forward network.</p>
<p><img src="./Getting started with Torch7_files/lenet.jpg" alt=""></p>
<p>It takes the input, feeds it through several layers one after the other, and then finally gives the output.
Such a network container is <code>nn.Sequential</code> which feeds the input through several layers.</p>
<p>Let's use Torch to create a LeNet network in the cell below.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[15]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59644px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 957.446px; margin-bottom: -15px; border-right-width: 15px; min-height: 207px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span> = <span class="cm-variable">nn.Sequential</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">1</span>, <span class="cm-number">6</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>)) <span class="cm-comment">-- 1 input image channel, 6 output channels, 5x5 convolution kernel</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialMaxPooling</span>(<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>))     <span class="cm-comment">-- A max-pooling operation that looks at 2x2 windows and finds the max.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">6</span>, <span class="cm-number">16</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialMaxPooling</span>(<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.View</span>(<span class="cm-number">16</span>*<span class="cm-number">5</span>*<span class="cm-number">5</span>))                    <span class="cm-comment">-- reshapes from a 3D tensor of 16x5x5 into 1D tensor of 16*5*5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">16</span>*<span class="cm-number">5</span>*<span class="cm-number">5</span>, <span class="cm-number">120</span>))             <span class="cm-comment">-- fully connected layer (matrix multiplication between input and weights)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">120</span>, <span class="cm-number">84</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">84</span>, <span class="cm-number">10</span>))                   <span class="cm-comment">-- 10 is the number of outputs of the network (in this case, 10 digits)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.LogSoftMax</span>())                     <span class="cm-comment">-- converts the output to a log-probability. Useful for classification problems</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'Lenet5\n'</span> .. <span class="cm-variable">net</span>:<span class="cm-variable">__tostring</span>());</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 223px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[15]:</div><div class="output_subarea output_text output_result"><pre>Lenet5
nn.Sequential {
  [input -&gt; (1) -&gt; (2) -&gt; (3) -&gt; (4) -&gt; (5) -&gt; (6) -&gt; (7) -&gt; (8) -&gt; (9) -&gt; output]
  (1): nn.SpatialConvolution(in: 1, out: 6, kW: 5, kH: 5)
  (2): nn.SpatialMaxPooling(kW: 2, kH: 2, dW: 2, dH: 2)
  (3): nn.SpatialConvolution(in: 6, out: 16, kW: 5, kH: 5)
  (4): nn.SpatialMaxPooling(kW: 2, kH: 2, dW: 2, dH: 2)
  (5): nn.View
  (6): nn.Linear(400 -&gt; 120)
  (7): nn.Linear(120 -&gt; 84)
  (8): nn.Linear(84 -&gt; 10)
  (9): nn.LogSoftMax
}	
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 125px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Every neural network module in Torch has <span class="cm-link">[automatic differentiation]</span><span class="cm-string">(https://en.wikipedia.org/wiki/Automatic_differentiation)</span>. It has a :forward(input) function that computes the output for a given input, flowing the input through the network. and it has a :backward(input, gradient) function that will differentiate each neuron in the network w.r.t. the gradient that is passed in. This is done via the <span class="cm-link">[chain rule]</span><span class="cm-string">(https://en.wikipedia.org/wiki/Chain_rule)</span>.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Let's next use the <span class="cm-comment">`:forward`</span> and <span class="cm-comment">`:backward`</span> functions with the LeNet we just created on some random input data.  Excute the cells below and see if you can understand what is happening.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 125px;"></div><div class="CodeMirror-gutters" style="display: none; height: 141px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Every neural network module in Torch has <a href="https://en.wikipedia.org/wiki/Automatic_differentiation" target="_blank">automatic differentiation</a>. It has a :forward(input) function that computes the output for a given input, flowing the input through the network. and it has a :backward(input, gradient) function that will differentiate each neuron in the network w.r.t. the gradient that is passed in. This is done via the <a href="https://en.wikipedia.org/wiki/Chain_rule" target="_blank">chain rule</a>.</p>
<p>Let's next use the <code>:forward</code> and <code>:backward</code> functions with the LeNet we just created on some random input data.  Excute the cells below and see if you can understand what is happening.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 580.273px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">input</span> = <span class="cm-variable">torch.rand</span>(<span class="cm-number">1</span>,<span class="cm-number">32</span>,<span class="cm-number">32</span>) <span class="cm-comment">-- pass a random tensor as input to the network</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[17]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 210.813px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">output</span> = <span class="cm-variable">net</span>:<span class="cm-variable">forward</span>(<span class="cm-variable">input</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[18]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 103px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">output</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[18]:</div><div class="output_subarea output_text output_result"><pre>-2.3383
-2.2593
-2.2774
-2.2259
-2.2760
-2.2493
-2.3826
-2.3267
-2.3569
-2.3460
[torch.DoubleTensor of size 10]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[19]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 795.727px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">zeroGradParameters</span>() <span class="cm-comment">-- zero the internal gradient buffers of the network (will come to this later)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[20]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 364.761px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">gradInput</span> = <span class="cm-variable">net</span>:<span class="cm-variable">backward</span>(<span class="cm-variable">input</span>, <span class="cm-variable">torch.rand</span>(<span class="cm-number">10</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[21]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 133.852px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(#<span class="cm-variable">gradInput</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[21]:</div><div class="output_subarea output_text output_result"><pre>
  1
 32
 32
[torch.LongStorage of size 3]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">So we've plucked a random tensor out and given it to the network as input. Simply by passing this into the forward() function of the net it is processed - fed forward - and output as "output". </span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>So we've plucked a random tensor out and given it to the network as input. Simply by passing this into the forward() function of the net it is processed - fed forward - and output as "output". </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 161px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0908px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">##Criterion: Defining a loss function</span></span></pre><pre class=""><span style="padding-right: 0.1px;">When you want a model to learn to do something, you give it feedback on how well it is doing. The function that computes an objective measure of the model's performance is called a loss function and it typically takes in the model's output and the groundtruth and computes a value that quantifies the model's performance.</span></pre><pre class=""><span style="padding-right: 0.1px;">The model then corrects itself to have a smaller loss.</span></pre><pre class=""><span style="padding-right: 0.1px;">In Torch, loss functions are implemented just like neural network modules, and have automatic differentiation.</span></pre><pre class=""><span style="padding-right: 0.1px;">They have two functions - <span class="cm-comment">`forward(input, target)`</span> and <span class="cm-comment">`backward(input, target)`</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For example:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 176px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Criterion:-Defining-a-loss-function">Criterion: Defining a loss function<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Criterion:-Defining-a-loss-function"></a></h2>
<p>When you want a model to learn to do something, you give it feedback on how well it is doing. The function that computes an objective measure of the model's performance is called a loss function and it typically takes in the model's output and the groundtruth and computes a value that quantifies the model's performance.
The model then corrects itself to have a smaller loss.
In Torch, loss functions are implemented just like neural network modules, and have automatic differentiation.
They have two functions - <code>forward(input, target)</code> and <code>backward(input, target)</code></p>
<p>For example:</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[22]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 803.511px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">criterion</span> = <span class="cm-variable">nn.ClassNLLCriterion</span>() <span class="cm-comment">-- a negative log-likelihood criterion for multi-class classification</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">criterion</span>:<span class="cm-variable">forward</span>(<span class="cm-variable">output</span>, <span class="cm-number">3</span>) <span class="cm-comment">-- let's say the groundtruth was class number: 3</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">gradients</span> = <span class="cm-variable">criterion</span>:<span class="cm-variable">backward</span>(<span class="cm-variable">output</span>, <span class="cm-number">3</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[23]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 326.281px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">gradInput</span> = <span class="cm-variable">net</span>:<span class="cm-variable">backward</span>(<span class="cm-variable">input</span>, <span class="cm-variable">gradients</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 227px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3638px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Recap</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Networks takes an input and produce an output in the <span class="cm-comment">`:forward`</span> pass. </span></pre><pre class=""><span style="padding-right: 0.1px;">'Criterion' computes the loss of the network, and its gradients with respect to the output of the network.</span></pre><pre class=""><span style="padding-right: 0.1px;">Network takes an (input, gradients) pair in its backward pass and calculates the gradients with respect to each layer (and neuron) in the network.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Next</span></span></pre><pre class=""><span style="padding-right: 0.1px;">A neural network layer can have learnable parameters or not.</span></pre><pre class=""><span style="padding-right: 0.1px;">A convolution layer learns its convolution kernels to adapt to the input data and the problem being solved.</span></pre><pre class=""><span style="padding-right: 0.1px;">A max-pooling layer has no learnable parameters. It only finds the max of local windows.</span></pre><pre class=""><span style="padding-right: 0.1px;">A layer in Torch which has learnable weights, will typically have fields <span class="cm-comment">`.weight`</span> (and optionally <span class="cm-comment">`.bias`</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 227px;"></div><div class="CodeMirror-gutters" style="display: none; height: 243px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Recap">Recap<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Recap"></a></h3>
<p>Networks takes an input and produce an output in the <code>:forward</code> pass. 
'Criterion' computes the loss of the network, and its gradients with respect to the output of the network.
Network takes an (input, gradients) pair in its backward pass and calculates the gradients with respect to each layer (and neuron) in the network.</p>
<h3 id="Next">Next<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Next"></a></h3>
<p>A neural network layer can have learnable parameters or not.
A convolution layer learns its convolution kernels to adapt to the input data and the problem being solved.
A max-pooling layer has no learnable parameters. It only finds the max of local windows.
A layer in Torch which has learnable weights, will typically have fields <code>.weight</code> (and optionally <code>.bias</code>)</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[24]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 511.011px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3635px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">m</span> = <span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">1</span>,<span class="cm-number">3</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>) <span class="cm-comment">-- learn 3 2x2 kernels</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">m.weight</span>) <span class="cm-comment">-- initially, the weights are randomly initialized</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[24]:</div><div class="output_subarea output_text output_result"><pre>(1,1,.,.) = 
 -0.3519  0.3794
 -0.4857  0.1471

(2,1,.,.) = 
  0.0102  0.0145
 -0.3960 -0.2704

(3,1,.,.) = 
 -0.3426  0.3200
 -0.1457  0.1688
[torch.DoubleTensor of size 3x1x2x2]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[25]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 764.818px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">m.bias</span>) <span class="cm-comment">-- The operation in a convolution layer is: output = convolution(input,weight) + bias</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[25]:</div><div class="output_subarea output_text output_result"><pre> 0.2504
-0.1604
 0.0898
[torch.DoubleTensor of size 3]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 572px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">There are also two other important fields in a learnable layer. The <span class="cm-comment">`gradWeight`</span> and <span class="cm-comment">`radBias`</span>. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">`gradWeight`</span> accumulates the gradients with respect to each weight in the layer, and <span class="cm-comment">`gradBias`</span>, with respect to each bias in the layer.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">##Training the network</span></span></pre><pre class=""><span style="padding-right: 0.1px;">For the network to adjust itself, it typically does this operation (if you do Stochastic Gradient Descent):</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">`weight = weight + learningRate * gradWeight [equation 1]`</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">This update over time will adjust the network weights such that the output loss is decreasing.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">###How does each layer in the neural network update the weight according to equation 1?</span></span></pre><pre class=""><span style="padding-right: 0.1px;">A simple SGD trainer in the neural network module: <span class="cm-comment">`nn.StochasticGradient`</span> has a function <span class="cm-comment">`:train(dataset)`</span> that takes a given dataset and simply trains your network by showing different samples from your dataset to the network.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-4">####What about data?</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Torch has simple dataloaders: <span class="cm-comment">`image.load`</span> or <span class="cm-comment">`audio.load`</span> to load your data into a <span class="cm-comment">`torch.Tensor`</span> or a Lua table.</span></pre><pre class=""><span style="padding-right: 0.1px;">We'll use the CIFAR-10 dataset, which has the classes: 'airplane', 'automobile', 'bird', 'cat', 'deer', 'dog', 'frog', 'horse', 'ship', 'truck'.</span></pre><pre class=""><span style="padding-right: 0.1px;">The images in CIFAR-10 are of size 3x32x32, i.e. 3-channel colour images of 32x32 pixels in size.</span></pre><pre class=""><span style="padding-right: 0.1px;">The dataset has 50,000 training images and 10,000 test images in total.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(images/CIFAR10.jpg)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">We now have 5 steps left to train a Torch neural network</span></pre><pre class=""><span style="padding-right: 0.1px;">1. Load and normalize data</span></pre><pre class=""><span style="padding-right: 0.1px;">2. Define Neural Network</span></pre><pre class=""><span style="padding-right: 0.1px;">3. Define Loss function</span></pre><pre class=""><span style="padding-right: 0.1px;">4. Train network on training data</span></pre><pre class=""><span style="padding-right: 0.1px;">5. Test network on test data.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**1. Load and normalize data**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">In the interest of time, we prepared the data before-hand into a 4D torch ByteTensor of size 10000x3x32x32 (training) and 10000x3x32x32 (testing) Let us load the data and inspect it.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 572px;"></div><div class="CodeMirror-gutters" style="display: none; height: 587px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>There are also two other important fields in a learnable layer. The <code>gradWeight</code> and <code>radBias</code>. 
<code>gradWeight</code> accumulates the gradients with respect to each weight in the layer, and <code>gradBias</code>, with respect to each bias in the layer.</p>
<h2 id="Training-the-network">Training the network<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Training-the-network"></a></h2>
<p>For the network to adjust itself, it typically does this operation (if you do Stochastic Gradient Descent):</p>
<p><code>weight = weight + learningRate * gradWeight [equation 1]</code></p>
<p>This update over time will adjust the network weights such that the output loss is decreasing.</p>
<h3 id="How-does-each-layer-in-the-neural-network-update-the-weight-according-to-equation-1?">How does each layer in the neural network update the weight according to equation 1?<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#How-does-each-layer-in-the-neural-network-update-the-weight-according-to-equation-1?"></a></h3>
<p>A simple SGD trainer in the neural network module: <code>nn.StochasticGradient</code> has a function <code>:train(dataset)</code> that takes a given dataset and simply trains your network by showing different samples from your dataset to the network.</p>
<h4 id="What-about-data?">What about data?<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#What-about-data?"></a></h4>
<p>Torch has simple dataloaders: <code>image.load</code> or <code>audio.load</code> to load your data into a <code>torch.Tensor</code> or a Lua table.
We'll use the CIFAR-10 dataset, which has the classes: 'airplane', 'automobile', 'bird', 'cat', 'deer', 'dog', 'frog', 'horse', 'ship', 'truck'.
The images in CIFAR-10 are of size 3x32x32, i.e. 3-channel colour images of 32x32 pixels in size.
The dataset has 50,000 training images and 10,000 test images in total.</p>
<p><img src="./Getting started with Torch7_files/CIFAR10.jpg" alt=""></p>
<p>We now have 5 steps left to train a Torch neural network</p>
<ol>
<li>Load and normalize data</li>
<li>Define Neural Network</li>
<li>Define Loss function</li>
<li>Train network on training data</li>
<li>Test network on test data.</li>
</ol>
<p><strong>1. Load and normalize data</strong>
In the interest of time, we prepared the data before-hand into a 4D torch ByteTensor of size 10000x3x32x32 (training) and 10000x3x32x32 (testing) Let us load the data and inspect it.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[26]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 549.364px; margin-bottom: -15px; border-right-width: 15px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainset</span> = <span class="cm-variable">torch.load</span>(<span class="cm-string">'/home/ubuntu/data/cifar.torch/cifar10-train.t7'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">testset</span> = <span class="cm-variable">torch.load</span>(<span class="cm-string">'/home/ubuntu/data/cifar.torch/cifar10-test.t7'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">classes</span> = {<span class="cm-string">'airplane'</span>, <span class="cm-string">'automobile'</span>, <span class="cm-string">'bird'</span>, <span class="cm-string">'cat'</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;">           <span class="cm-string">'deer'</span>, <span class="cm-string">'dog'</span>, <span class="cm-string">'frog'</span>, <span class="cm-string">'horse'</span>, <span class="cm-string">'ship'</span>, <span class="cm-string">'truck'</span>}</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[27]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59662px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 118.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">trainset</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[27]:</div><div class="output_subarea output_text output_result"><pre>{
  data : ByteTensor - size: 10000x3x32x32
  label : ByteTensor - size: 10000
}
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[28]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59662px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 164.634px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(#<span class="cm-variable">trainset.data</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[28]:</div><div class="output_subarea output_text output_result"><pre>
 10000
     3
    32
    32
[torch.LongStorage of size 4]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Lets display an image:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Lets display an image:</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[29]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 549.364px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">itorch.image</span>(<span class="cm-variable">trainset.data</span>[<span class="cm-number">100</span>]) <span class="cm-comment">-- display the 100-th image in dataset</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">classes</span>[<span class="cm-variable">trainset.label</span>[<span class="cm-number">100</span>]])</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAJaUlEQVRIiQXB228j53UA8HO+y8zH4QxJkZQoUdqLZHml3bVjN6mL1G6cbYIiQXpDgMIPLfpQoAXykpe2j30p0NfmT2ge+lAUBYoiaIAgCWIYMGLDhpOt7Vx8We96L1qJokRySM7Mdzunvx++eue5VXkZnJVaZBkyKRDKWasVRO+0KhBQJ+nGYNTrbH/wwZvA7ubRc19+4eX3/u+d05MPs1SPi832cP8LrxyUdv6b++9sj4rRoEiz2MvT9+8GhWi1BJEYlQpAQJbN2hKQTlJUjCoAJLNyMZ3N6vouArVb5mx28ZO3fkYYS9e0WqZsml4nb6WHV3aK+eKkP2iKjqzselUlJtPKR24V7cYBxSYGbRub5zn7MhIRilQhiJU2xi3r1CSAgdGdTB5qrWwVE4ZW4qyI7sGHlXti0o3xlb1m+euzZZQJLnk9ubTy8MawXNUURWaSTpEJyYBc19a0jAKwtqlLEhJDCEoJFIDEJtXRa/YCyAvgtjRRWB+bJ6dPR6MDJcWqWs0vuVy684VV62XtG+h1TVNXMYTFwpVlORgUuYFFGeoV60RV68BMzMLWkTyjpFRHNBwigMBMYu3wfLZOU1POL2YLO5naTkeEAPUaVWKkMXpVLnyIzilrV/2B7nTg7GTlyKdGag3K6KbCpvEmVRYcU4gSNIroUSSqNjhfuxCj3NBPzx47qhvfNLWJkWob5XDYCdFLAUprgXzlIBuP22QBlAAMUivvYqcre0OpNDLAYGR6eRY8BGZEGZFVkllrY+1i9Kvaap1F8j40SqD1S3l0uNHKVHCUKshMIoSU7D1SpwerZajW4KPvDVW/q3xNOpNZKwHJddN0+ymgrNbO1d4kSmlBhMwyUFyWS2aZtpLNrY4cX9mYXazzos3sSMqsY2tPwdlUSwDRyZIQovPoPUngoqu99a5pWnmaKm1SMZ34ltEuNkKDtdRUDiAKhd7HEENdN7LXT2JwLOTlReMbr7RAQgERABBjloGPLBCQiFBVtUMWSiQk6jRJgxXlwtd1zPLUet9Y6vVSW8fauaYO66XN0pY8vD5clNV67WJEJlYSdw8yQbCsfQhkAyVt2RsmgsR64QIxB3Y+Ji2UCRS9pJ1LqSMxEVHWFhsbioI4m1Tttul1WxSdylpGaCmIjYHhyAxHKkRbrqKrIPjYH7d6fbA2LmsbmNiK7cPEN1FilCqCCCoJ7VydT1w7VTrFxSoU7WTczmcr2+lKY6QM3MQodSJ29rLhkAWK4JSUaBJ9MfXdfhJCvJyE4IgppFmaJCSlAE7KZbSNB48Qxap0CiBB8rWLLK92tQcLUknQgkjb2rdzPDhuU0imp544dnqKwQ3GOiu4WqJ38aX9G3/9yldESqDws4+q5bphphBwVcdy7ZShncPMdA1E2fb1rFwGUKvKR+Hl7euji8VSalpVzeVlLWQ6PWtCDLb2RHq1DIkRi8vm28+//Kcvf7UsF/OJfW584/RiiYpiZcbbo8tJPUp7e5stZUUK2aL0mLSrQHk73dSpfOH4ahWq2bmgqJKMvPXKAFm5XtJybacnUYJpajHa27Jnsy/t7G6nnW88/4X/eeu9yeXy5o0vHlzfr6tZuSZBnbVu7NJVVGyNxyydFLJo9+R4rwUyrWvvG5dq3e3py8tg2lSXPJlau/YXZ3VV4t9895/Wop1NZ6fzx8byi7/7vCQcXD3a3dzFliM+n03mS/ZOoFvzZFmdzmaJSvcPjmSMNF+sW5kcX5eRowuMDE/OOcvEtSzNu7tFkW1tDb7z3X8Y7z2TsXzzV/efPP7k66/eCVXzxvv3vvnqyyw7tXdj2bt2/+RmwFuQ7Aq9K9UgMywB97Y3tabEoEcX125wYJQrvrGUr52f/GDr+o+KDkbrIvz+na//1R9+LXz26et3f/50cvIHt56bLmYk5cR07MVZcXj9KNCfZVsaIrda3Hh6PKlPnj6890u5t2c2h8VsVdYLuFjw77W3vnf1+deOvjTq78/nFz/G6ENkgieffLS/u3H55OOrB4M/+pO/bO0fDW8e/eAnP002BsXecMzZS628e/xs/MrX4Fvf5qJDF+fi9OHo6Ql+9fZ2beNisdYt+S1s/WOy0e1vBCJ1/wHU9t+66X8XnTlGp+Sdvb0hyleGW7tbY39xntf+s3ffHyB0DeWLleZorMPtbXz2FuWZWC14PoPS4nf+/Nm830FUo3tnf/eQ5MGhunYL336bH/4GIQUK5/3uRTFYJbif5v3uAFsSE8VZLju53BxAVnBmSCUxOBKo+kMpJOiEEPj11+FHP8V/+dsvay0j8Tf/95ObxVDcehEefY4P7sMzt/HFF+DKruptQJpAY2l6Bhfn0QXRypFcXFUYiRPBGNgGtjUL5E4hTRc2unFvKOso60r1s3aqdHZWPrNyuDqNj39YbY/E0Q04ehaGhTi7T7/8hZwvo20+5XXHhn7dpI4oVegj+IBJShDRRyEVQwSMsQFEaUzyOIa1AOWtdTYe//bMsAzBBwhmvsimc37nXSbvOXpmBIESr0uthZIcmEmAZCZkAooSABgFMTAjCgDhIX5P4H8IKBlUrz8Ii7jzYOGqkpklQ9Oc/1zr9e4GOr+zbA5XDQJCiDoEAIiMCMCAgEAACMAAAAQAEQExJsD/nqh/7ZjjG4dXUlTGGPXWr3vzuQVGQIf4z1l698rW1ZvHm9vXpx//6vDNd//eBglIIBgAESIyAgoGAEYAwcCIDICAimiB/J9aHeyMXvvjv2i3U+GqcPNeqdIkJUgo/kzpH/c3tod5AqtB3soH+Q+vbL4pBQuMAhQyIktmxSyAAJiRGRmAEVgCP7rWf38zf5LK0bD46MFvPz+5L2TWf/el4yf7z0y1dELfFVFpMGlytd1203uGV51u9w2jFIGJEYkUkWIWTMismCWBYEBmZBZMrcaeMIg0HWQpre+7px+rJKGzveK/TuIvttph0XwSI5JIiv721gip+nydOFtPWc12upfHt3UMilFElpEBEYCAIgsEYApRgMiWlXv8KbZlIDrobVP0qt3upya8YcTbMawEKcCiLHVrY+f2nfXFdPLo9ZWN74Xm+418ND2RCImQCUoSKKVERABGRgREKRDQdZKPFDLBMiqX5SbN1Xhvl3XySr062tlaNw1FenB28eGHHxwffTFv56eT+eLy0rbw+8KJR/eXjfM+CkAGYAZEZgAEEAACIVHYy4tJ9H5WTi6XHouDa7/z/3hTpCVo8fqAAAAAAElFTkSuQmCC" height="32" width="32"></div></div><div class="output_area"><div class="prompt output_prompt">Out[29]:</div><div class="output_subarea output_text output_result"><pre>automobile	
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">To prepare the dataset to be used with <span class="cm-strong">**nn.StochasticGradient**</span>, the dataset has to have a <span class="cm-comment">`:size()`</span> function and an <span class="cm-comment">`[i]`</span> index operator, so that <span class="cm-comment">`dataset[i]`</span> returns the ith sample in the datset.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>To prepare the dataset to be used with <strong>nn.StochasticGradient</strong>, the dataset has to have a <code>:size()</code> function and an <code>[i]</code> index operator, so that <code>dataset[i]</code> returns the ith sample in the datset.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[30]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 849.364px; margin-bottom: -15px; border-right-width: 15px; min-height: 191px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- ignore setmetatable for now, it is a feature beyond the scope of this tutorial. It sets the index operator.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">setmetatable</span>(<span class="cm-variable">trainset</span>, </span></pre><pre class=""><span style="padding-right: 0.1px;">    {<span class="cm-variable">__index</span> = <span class="cm-keyword">function</span>(<span class="cm-variable">t</span>, <span class="cm-variable">i</span>) </span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-keyword">return</span> {<span class="cm-variable">t.data</span>[<span class="cm-variable">i</span>], <span class="cm-variable">t.label</span>[<span class="cm-variable">i</span>]} </span></pre><pre class=""><span style="padding-right: 0.1px;">                <span class="cm-keyword">end</span>}</span></pre><pre class=""><span style="padding-right: 0.1px;">);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainset.data</span> = <span class="cm-variable">trainset.data</span>:<span class="cm-variable">double</span>() <span class="cm-comment">-- convert the data from a ByteTensor to a DoubleTensor.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">function</span> <span class="cm-variable">trainset</span>:<span class="cm-variable">size</span>() </span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">return</span> <span class="cm-variable">self.data</span>:<span class="cm-variable">size</span>(<span class="cm-number">1</span>) </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 191px;"></div><div class="CodeMirror-gutters" style="display: none; height: 206px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[31]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 295.486px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">trainset</span>:<span class="cm-variable">size</span>()) <span class="cm-comment">-- just to test</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[31]:</div><div class="output_subarea output_text output_result"><pre>10000	
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[32]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 349.364px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">trainset</span>[<span class="cm-number">33</span>]) <span class="cm-comment">-- load sample number 33.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">itorch.image</span>(<span class="cm-variable">trainset</span>[<span class="cm-number">33</span>][<span class="cm-number">1</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[32]:</div><div class="output_subarea output_text output_result"><pre>{
  1 : DoubleTensor - size: 3x32x32
  2 : 2
}
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAKCklEQVRIiTXWWXNcZ52A8ff/Lmc/vaq71eq2ZEmWvMiWLZHgxCbOTAiYAAnFpKiBKi6giqq5mM8BH2DmgrmYraCgZoqlWCphuYiNE1c2YseR5EXR0pJbarVkq/v02c95Fy6A3wd4rh9Y/oc5UDRO0Fjdmj89s9XZ/vTjbuxxKWWaxo5rx3HCGDNda2pybPHyqXqzlETJ6Gj0ztubC4vXKkUS9Xce7Xjd3UcZV0JJCvDNL79y84OPdve6XEh6amFSI2YUxkLGURS2W+1GtZZHyh+NCgXTLpiC40qljDXZapeTnO8ddDGytraP+73g9CXmDffb49YwRqOBM4pTBEhmIo1iKZVSSAhJ1+71EFeGyTAGQHngR6fPtYI4LNdrjsuiIPGGo93uoW5pqyuPJYoqVVfyQHNS2yH3Pno3ftp74coZBDZmRBOMUhxkESGEc56mOeec9h73LV1DVScYRQCI5/nultCo+WjtE45jhjSMseeNLj0zd9jzHFeP4kRjcjiIOOe7a5+ILLuBeKs+ToUYMyw/DYQQQkqlkFJIKkExkCTJjSjzR9F4syy41u/7hUKma7TouE88HxSxCtp2p8OonSZQ1N1y2dVAzjYctCD3egfl8cqZcxdM111onXjzD2/eun2bgUKSA0IAQBUI09KOnniU0uPjADMkMRqledGu+N6QYAoor1ils/OLMydmT07NLp49J4Vce7i187jTPehht4YB7+55V65f/tJr18u18fHmRIUgBFiBQggRo0gtiyEEtmvxXFgOq1SqDCGsIE5DmclWvfat7/7g1MXrtDwdskKQ4/s7j9e6uz52Ec7L462JycmNu/dYkrz+T6/Nzc9fOnOp+3Dj1t2PoywlStFCQc9TTjWcJIFuMNuyXdPFms15hlgWpeHiF76dVE5u9nZ4lpM0u7m9E/oDU09OL1y9+tLiRLE0255oufSn//+Ln/3yF8ufeaZg2AplBnBKIJFAdNt0HR0TxBhmVDlGoeLWikVX8gwjMjMxu/Did4LIyxP/yfGRTCJvEPhR1BgvNurjksXDYVgrlsebzTd/9+bG6rpLcLNgPek8vPnhn0dBgJlGdYMoySnDhBDEca1SnZuZ+/P9WwY2VYImz75AqJnFfamEDozLOAYBedCsz1+cnjAc8ujhg3//0f8QxPMsjwr0wPf/7b/+W2WCWzVyPJJY0kJJl4IUDTuXoQLAOXIQzFbaUkORRtzJhdQfZmGG04CJKFfYxfjAD7c/ejDY6/J8EA4GnQNPGQW9MSML1u9Xt7zAZxS3Fs4nvpeEA1h67pwQccmoZyIlCGFm1MoNp1B2HRhvTBrti261IhUKvT1d5qmwozQZBQOUqo29bhqnHhg6oxhB6B+TZJhlIWiEZ1mzXLw8P2lSQjWlYVPLOaWm4H5iYmFIv65Drbkwc+VafXLWoAYxzUxeYCCp5LGQg4jfubeZ+8kg7qWxlw19IXIApAN3LRZlWcEwbEpnx+oIMcpz5VBUL/BTY8bJS1Ol6XPtC0ul9mnfGU+VKZIwIwyU1EwzyeWD9Y0bt95fW3sUDXsMZzoIhYjCVDeYY1KLESEwRIGrEaRwRUTL7Qb9168stmslZ3IGJs7pjVNGsSqpFo9iZlo4FwHVYiF5zN+7fff2O7cPdh6LdMRoUtAVUwbGJmNQMhggoROKhFy9fz/P04tn5gF47bnPrXxwg85ddJ/6Lm1eOX12iSjBsGQY4ZJJAXGC+pFYf7D61ocrb7x7p0ixSzgYmNCCRcEApFAOSmlCxZJneaaEgMQLng7IwvkkDW/cfO/FqkP/+HCzgacP7v98a/p9q1glUiJCcy64kClPdnZ2Yz80LWu+iJhuDYZDBWaJKkZlnGc8F0KgkGdISapRDaPmROvw8PDBw7W5oi0//bg6+wW6hFt7XtI+ubS+vYlEh+eK6pppmRIB0wggNTs/12w2H/zmN8I7wETr9vcy17Io4YITiTBgRjHDTCEUe6M4FWdPtj//3NKVC2cLpbGNKCcC2W9vhUuXFssF5+kozLMYYUwVUImwRI1y9eTkpFLy0VYn4KrXPXz49luCq0q9DkhqjDFD1zF9Mhzs9vfjJGIA3/vm69dfvBYgww8jqjMydfWr1//xWqtW3O0fSclNXQdCFBAFIAD6x087vb2xsbHeftcPRk8f75ogRoPj9swM03XJxWjgHz59QkA1S5XU95Hk9VrNCxJvdBwL7iWS/uBfXi87pb6k93c6Jybb/f4QhHRsGyRPMo4xPR4eu6Xak4xJBBPjVbNVunH7Q3/k50rGSVpwrLmJRjAYfrq6cnBwcPL07H/8748VIphSw3TCTFIUHd3Z2wzNmYULz9old+oC6Jpt6zSOojiJTQpxEkdKn5i90Hvo73d3cs1kmB7t71UbjValjPLk3sd3Op2dLMsxg+2t7SzNqWkRpvthNN6oUyPcmRbihz/9VQ3o1JkzHlcrd1cVZcvPXzU1Yui6rrFI8Oqo9+7mupCEAaYUjxVcC9TGyr39/f0s5wAIEwwKpAS7WMqFtAz92meXv3b9ZVqzTSgXWuVCRWKllMjyqVbVy1Xsd6VWfXI0ICBMx/7Dzbd6/f50o24QSQCtP3rkj0ZcCGAaIRgpgTXDcMqZyqWUF+fnXn/tlaXF82mSUJ8nYRZ849VlyfWf/f7DH73x9uWLS7Rg3X7jT7bGSiXXi+Iklxsbm5kQoWvnOc+lGgyGhOC/pZlhWKZCoGP02XMLl59ZfnbpkuvYYRAJheiBP4gEGo3obqeztrO3f9j9v9/uzI4Vv/+db8SG+c7a5srKeuewzxAwxoimTZw4+cnqfcBYKsQotR0LUSvJ0na9+s+vffnlq1cJI6MwDMIEUSaEoivr0epm7+7qRnf/8fLU+ImxRqd/NNZsbQ+8D7bXb91ZGQYxQUSC4ILvdbsjzxc8Y0zTDINqBlfI0ej1zz376pe+2G61oiRJgwQTSgiO0iRNMpifah4PvZqlv/L8s6++cPU/b773k1//Dv0VEEwBAFGEFQKEASNEKZUIFNUwxjrFz1w8/5WXXjp/Zp5LmeVCUIwBA+AoDDjnlmXRr8/NTM+25paWi7V2GEfL89PDz1/bOzgM/OB4OAzjJM24QH8HCElm2nbV1hv12le/+PK155+nlHmjgEulMYYVUkp6vocxth0HAGDjJz8MzUIkVRwGDEuD0gQhj6PjUXBweBRGcZJlfhSGYaSkivyIS35h4dypySm35JYLZS5UpqREf50gyASPk5gQYhqGUkpJRTuunSUCxTkCFTM25EpKDlw1ysUTzXGJgGmapmtIKpHlICQGUEpEiqSSe3FMKUMKAQGEcRRHSZJYlsUoU0IopZRSFIUI8xxrBBGbAgUAJSVnHGHIMq6USqMYKSWEAIRAY4hgiZTCSlGpqCYRKCmRQmEccM5t28YEc8EJACCQUvwFsdS0N/rVv58AAAAASUVORK5CYII=" height="32" width="32"></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**One of the most important things you can do in conditioning your data (in general in data-science or machine learning) is to make your data have a mean of 0.0 and standard-deviation of 1.0.**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">This is the final step of our data processing via the tensor indexing operator. It is shown by example:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>One of the most important things you can do in conditioning your data (in general in data-science or machine learning) is to make your data have a mean of 0.0 and standard-deviation of 1.0.</strong>
This is the final step of our data processing via the tensor indexing operator. It is shown by example:</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[33]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1019px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1019.04px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 15px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">redChannel</span> = <span class="cm-variable">trainset.data</span>[{ {}, {<span class="cm-number">1</span>}, {}, {}  }] <span class="cm-comment">-- this picks {all images, 1st channel, all vertical pixels, all horizontal pixels}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 42px;"></div><div class="CodeMirror-gutters" style="display: none; height: 57px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[34]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 141.182px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(#<span class="cm-variable">redChannel</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[34]:</div><div class="output_subarea output_text output_result"><pre>
 10000
     1
    32
    32
[torch.LongStorage of size 4]

</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3643px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">In this indexing operator, you initally start with [{ }]. You can pick all elements in a dimension using {} or pick a particular element using {i} where i is the element index. You can also pick a range of elements using {i1, i2}, for example {3,5} gives us the 3,4,5 elements.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>In this indexing operator, you initally start with [{ }]. You can pick all elements in a dimension using {} or pick a particular element using {i} where i is the element index. You can also pick a range of elements using {i1, i2}, for example {3,5} gives us the 3,4,5 elements.</p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Moving back to mean-subtraction and standard-deviation based scaling, doing this operation is simple, using the indexing operator that we learnt above:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Moving back to mean-subtraction and standard-deviation based scaling, doing this operation is simple, using the indexing operator that we learnt above:</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[36]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 580.273px; margin-bottom: -15px; border-right-width: 15px; min-height: 191px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">mean</span> = {} <span class="cm-comment">-- store the mean, to normalize the test set in the future</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">stdv</span>  = {} <span class="cm-comment">-- store the standard-deviation for the future</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span>=<span class="cm-number">1</span>,<span class="cm-number">3</span> <span class="cm-keyword">do</span> <span class="cm-comment">-- over each image channel</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">mean</span>[<span class="cm-variable">i</span>] = <span class="cm-variable">trainset.data</span>[{ {}, {<span class="cm-variable">i</span>}, {}, {}  }]:<span class="cm-variable">mean</span>() <span class="cm-comment">-- mean estimation</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-string">'Channel '</span> .. <span class="cm-variable">i</span> .. <span class="cm-string">', Mean: '</span> .. <span class="cm-variable">mean</span>[<span class="cm-variable">i</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">trainset.data</span>[{ {}, {<span class="cm-variable">i</span>}, {}, {}  }]:<span class="cm-variable">add</span>(-<span class="cm-variable">mean</span>[<span class="cm-variable">i</span>]) <span class="cm-comment">-- mean subtraction</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    </span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">stdv</span>[<span class="cm-variable">i</span>] = <span class="cm-variable">trainset.data</span>[{ {}, {<span class="cm-variable">i</span>}, {}, {}  }]:<span class="cm-variable">std</span>() <span class="cm-comment">-- std estimation</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-string">'Channel '</span> .. <span class="cm-variable">i</span> .. <span class="cm-string">', Standard Deviation: '</span> .. <span class="cm-variable">stdv</span>[<span class="cm-variable">i</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">trainset.data</span>[{ {}, {<span class="cm-variable">i</span>}, {}, {}  }]:<span class="cm-variable">div</span>(<span class="cm-variable">stdv</span>[<span class="cm-variable">i</span>]) <span class="cm-comment">-- std scaling</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 191px;"></div><div class="CodeMirror-gutters" style="display: none; height: 206px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_text output_result"><pre>Channel 1, Mean: -5.8266863773096e-15	
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_text output_result"><pre>Channel 1, Standard Deviation: 1.0000000000011	
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_text output_result"><pre>Channel 2, Mean: -2.4524820108757e-15	
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_text output_result"><pre>Channel 2, Standard Deviation: 0.99999999999054	
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_text output_result"><pre>Channel 3, Mean: -2.8049709175368e-14	
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[36]:</div><div class="output_subarea output_text output_result"><pre>Channel 3, Standard Deviation: 1	
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.5957px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 176px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Our training data is now normalized and ready to be used.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**2. Define our neural network**</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">###Task 1: </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Modify the neural network from the Neural Networks section above and modify it to take 3-channel images (instead of 1-channel images as it was defined).</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">You can find the <span class="cm-link">[solution]</span><span class="cm-string">(#Task-#1-Answer)</span> in the Answers section below.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 176px;"></div><div class="CodeMirror-gutters" style="display: none; height: 192px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Our training data is now normalized and ready to be used.</p>
<p><strong>2. Define our neural network</strong></p>
<h3 id="Task-1:">Task 1:<a class="anchor-link" href="./Getting started with Torch7_files/Getting started with Torch7.html"></a></h3>
<p>Modify the neural network from the Neural Networks section above and modify it to take 3-channel images (instead of 1-channel images as it was defined).</p>
<p>You can find the <a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Task-#1-Answer">solution</a> in the Answers section below.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[41]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 957.446px; margin-bottom: -15px; border-right-width: 15px; min-height: 175px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span> = <span class="cm-variable">nn.Sequential</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">3</span>, <span class="cm-number">6</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>)) <span class="cm-comment">-- 1 input image channel, 6 output channels, 5x5 convolution kernel</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialMaxPooling</span>(<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>))     <span class="cm-comment">-- A max-pooling operation that looks at 2x2 windows and finds the max.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">6</span>, <span class="cm-number">16</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialMaxPooling</span>(<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.View</span>(<span class="cm-number">16</span>*<span class="cm-number">5</span>*<span class="cm-number">5</span>))                    <span class="cm-comment">-- reshapes from a 3D tensor of 16x5x5 into 1D tensor of 16*5*5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">16</span>*<span class="cm-number">5</span>*<span class="cm-number">5</span>, <span class="cm-number">120</span>))             <span class="cm-comment">-- fully connected layer (matrix multiplication between input and weights)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">120</span>, <span class="cm-number">84</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">84</span>, <span class="cm-number">10</span>))                   <span class="cm-comment">-- 10 is the number of outputs of the network (in this case, 10 digits)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.LogSoftMax</span>())                     <span class="cm-comment">-- converts the output to a log-probability. Useful for classification problems</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 175px;"></div><div class="CodeMirror-gutters" style="display: none; height: 190px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**3. Define the Loss function**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">A Log-likelihood classification loss is well suited for most classification problems.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>3. Define the Loss function</strong>
A Log-likelihood classification loss is well suited for most classification problems.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[42]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 264.705px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">criterion</span> = <span class="cm-variable">nn.ClassNLLCriterion</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**4. Train the neural network**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">First define an <span class="cm-strong">**nn.StochasticGradient**</span> object then we'll give our dataset to this object's :train function.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>4. Train the neural network</strong>
First define an <strong>nn.StochasticGradient</strong> object then we'll give our dataset to this object's :train function.</p>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[43]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 441.736px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainer</span> = <span class="cm-variable">nn.StochasticGradient</span>(<span class="cm-variable">net</span>, <span class="cm-variable">criterion</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainer.learningRate</span> = <span class="cm-number">0.001</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainer.maxIteration</span> = <span class="cm-number">5</span> <span class="cm-comment">-- just do 5 epochs of training.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 182.585px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 179.989px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 176.989px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre><span style="padding-right: 0.1px;"><span class="cm-variable">trainer</span>:<span class="cm-variable">train</span>(<span class="cm-variable">trainset</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 125px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-strong">**5. Test the network, print accuracy**</span></span></pre><pre class=""><span style="padding-right: 0.1px;">We have trained the network for 5 passes over the training dataset.</span></pre><pre class=""><span style="padding-right: 0.1px;">To check if the network has learnt anything we can check by predicting the class label that the neural network outputs, and comparing it to the ground-truth. If the prediction is correct, we add the sample to the list of correct predictions.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Lets display an image from the test set to get familiar.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 125px;"></div><div class="CodeMirror-gutters" style="display: none; height: 141px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><strong>5. Test the network, print accuracy</strong>
We have trained the network for 5 passes over the training dataset.
To check if the network has learnt anything we can check by predicting the class label that the neural network outputs, and comparing it to the ground-truth. If the prediction is correct, we add the sample to the list of correct predictions.</p>
<p>Lets display an image from the test set to get familiar.</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9599px; left: 243.778px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 264.634px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 238.182px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">classes</span>[<span class="cm-variable">testset.label</span>[<span class="cm-number">100</span>]])</span></pre><pre><span style="padding-right: 0.1px;"><span class="cm-variable">itorch.image</span>(<span class="cm-variable">testset.data</span>[<span class="cm-number">100</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Now normalize the test data with the mean and standard-deviation from the training data.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Now normalize the test data with the mean and standard-deviation from the training data.</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 54.6865px; left: 482.869px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 641.821px; margin-bottom: -15px; border-right-width: 15px; min-height: 93px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 477.273px; top: 49.0898px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">testset.data</span> = <span class="cm-variable">testset.data</span>:<span class="cm-variable">double</span>()   <span class="cm-comment">-- convert from Byte tensor to Double tensor</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span>=<span class="cm-number">1</span>,<span class="cm-number">3</span> <span class="cm-keyword">do</span> <span class="cm-comment">-- over each image channel</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">testset.data</span>[{ {}, {<span class="cm-variable">i</span>}, {}, {}  }]:<span class="cm-variable">add</span>(-<span class="cm-variable">mean</span>[<span class="cm-variable">i</span>]) <span class="cm-comment">-- mean subtraction    </span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">testset.data</span>[{ {}, {<span class="cm-variable">i</span>}, {}, {}  }]:<span class="cm-variable">div</span>(<span class="cm-variable">stdv</span>[<span class="cm-variable">i</span>]) <span class="cm-comment">-- std scaling</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 93px;"></div><div class="CodeMirror-gutters" style="display: none; height: 108px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9599px; left: 197.969px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 426.338px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 192.372px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- print the mean and standard-deviation of example-100</span></span></pre><pre><span style="padding-right: 0.1px;"><span class="cm-variable">horse</span> = <span class="cm-variable">testset.data</span>[<span class="cm-number">100</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">horse</span>:<span class="cm-variable">mean</span>(), <span class="cm-variable">horse</span>:<span class="cm-variable">std</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Lets see what the neural network thinks these examples above are:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Lets see what the neural network thinks these examples above are:</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9599px; left: 236.506px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 326.182px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 230.909px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">classes</span>[<span class="cm-variable">testset.label</span>[<span class="cm-number">100</span>]])</span></pre><pre><span style="padding-right: 0.1px;"><span class="cm-variable">itorch.image</span>(<span class="cm-variable">testset.data</span>[<span class="cm-number">100</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">predicted</span> = <span class="cm-variable">net</span>:<span class="cm-variable">forward</span>(<span class="cm-variable">testset.data</span>[<span class="cm-number">100</span>])</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9598px; left: 174.687px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 818.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 169.091px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- the output of the network is Log-Probabilities. To convert them to probabilities, you have to take e^x </span></span></pre><pre><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">predicted</span>:<span class="cm-variable">exp</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">You can see the network predictions. The network assigned a probability to each class, given the image.</span></pre><pre class=""><span style="padding-right: 0.1px;">To make it clearer, we can tag each probability with its class-name:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>You can see the network predictions. The network assigned a probability to each class, given the image.
To make it clearer, we can tag each probability with its class-name:</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 38.3232px; left: 28.3239px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 272.091px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 22.7273px; top: 32.7266px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span>=<span class="cm-number">1</span>,<span class="cm-variable">predicted</span>:<span class="cm-variable">size</span>(<span class="cm-number">1</span>) <span class="cm-keyword">do</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">classes</span>[<span class="cm-variable">i</span>], <span class="cm-variable">predicted</span>[<span class="cm-variable">i</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">For the real deal; how many in total are correct over the test set?</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>For the real deal; how many in total are correct over the test set?</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 90.2415px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 780.273px; margin-bottom: -15px; border-right-width: 15px; min-height: 158px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 84.6449px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">correct</span> = <span class="cm-number">0</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span>=<span class="cm-number">1</span>,<span class="cm-number">10000</span> <span class="cm-keyword">do</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">local</span> <span class="cm-variable">groundtruth</span> = <span class="cm-variable">testset.label</span>[<span class="cm-variable">i</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">local</span> <span class="cm-variable">prediction</span> = <span class="cm-variable">net</span>:<span class="cm-variable">forward</span>(<span class="cm-variable">testset.data</span>[<span class="cm-variable">i</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">local</span> <span class="cm-variable">confidences</span>, <span class="cm-variable">indices</span> = <span class="cm-variable">torch.sort</span>(<span class="cm-variable">prediction</span>, <span class="cm-keyword">true</span>)  <span class="cm-comment">-- true means sort in descending order</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">groundtruth</span> == <span class="cm-variable">indices</span>[<span class="cm-number">1</span>] <span class="cm-keyword">then</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">correct</span> = <span class="cm-variable">correct</span> + <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">end</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 158px;"></div><div class="CodeMirror-gutters" style="display: none; height: 174px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59659px; left: 328.778px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 326.182px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 323.182px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">correct</span>, <span class="cm-number">100</span>*<span class="cm-variable">correct</span>/<span class="cm-number">10000</span> .. <span class="cm-string">' % '</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Which classes performed well, and which didn't?</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Which classes performed well, and which didn't?</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9599px; left: 128.324px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 780.273px; margin-bottom: -15px; border-right-width: 15px; min-height: 158px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 122.727px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">class_performance</span> = {<span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span>=<span class="cm-number">1</span>,<span class="cm-number">10000</span> <span class="cm-keyword">do</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">local</span> <span class="cm-variable">groundtruth</span> = <span class="cm-variable">testset.label</span>[<span class="cm-variable">i</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">local</span> <span class="cm-variable">prediction</span> = <span class="cm-variable">net</span>:<span class="cm-variable">forward</span>(<span class="cm-variable">testset.data</span>[<span class="cm-variable">i</span>])</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">local</span> <span class="cm-variable">confidences</span>, <span class="cm-variable">indices</span> = <span class="cm-variable">torch.sort</span>(<span class="cm-variable">prediction</span>, <span class="cm-keyword">true</span>)  <span class="cm-comment">-- true means sort in descending order</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-variable">groundtruth</span> == <span class="cm-variable">indices</span>[<span class="cm-number">1</span>] <span class="cm-keyword">then</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">class_performance</span>[<span class="cm-variable">groundtruth</span>] = <span class="cm-variable">class_performance</span>[<span class="cm-variable">groundtruth</span>] + <span class="cm-number">1</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">end</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 158px;"></div><div class="CodeMirror-gutters" style="display: none; height: 174px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9598px; left: 305.597px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 464.676px; margin-bottom: -15px; border-right-width: 15px; min-height: 60px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 300px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span>=<span class="cm-number">1</span>,#<span class="cm-variable">classes</span> <span class="cm-keyword">do</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-builtin">print</span>(<span class="cm-variable">classes</span>[<span class="cm-variable">i</span>], <span class="cm-number">100</span>*<span class="cm-variable">class_performance</span>[<span class="cm-variable">i</span>]/<span class="cm-number">1000</span> .. <span class="cm-string">' %'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 60px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">To swap from CPU to GPU we simply take a neural network, and transfer it over to GPU:</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>To swap from CPU to GPU we simply take a neural network, and transfer it over to GPU:</p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9599px; left: 128.324px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 125.727px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 122.727px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">require</span> <span class="cm-string">'cunn'</span>; </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--brings in CUDA</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59656px; left: 128.324px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 126.082px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 122.727px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre><span style="padding-right: 0.1px;"><span class="cm-variable">net</span> = <span class="cm-variable">net</span>:<span class="cm-variable">cuda</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59662px; left: 198.324px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 218.455px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 192.727px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">criterion</span> = <span class="cm-variable">criterion</span>:<span class="cm-variable">cuda</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- transfer the criterion</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59662px; left: 236.506px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 280.045px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 230.909px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainset.data</span> = <span class="cm-variable">trainset.data</span>:<span class="cm-variable">cuda</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- transfer the data across</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 21.9598px; left: 182.869px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 441.693px; margin-bottom: -15px; border-right-width: 15px; min-height: 76px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 177.273px; top: 16.3633px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- and train on GPU </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainer</span> = <span class="cm-variable">nn.StochasticGradient</span>(<span class="cm-variable">net</span>, <span class="cm-variable">criterion</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainer.learningRate</span> = <span class="cm-number">0.001</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainer.maxIteration</span> = <span class="cm-number">5</span> <span class="cm-comment">-- just do 5 epochs of training.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 76px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59662px; left: 182.585px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 572.588px; margin-bottom: -15px; border-right-width: 15px; min-height: 44px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 176.989px; top: 0px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre><span style="padding-right: 0.1px;"><span class="cm-variable">trainer</span>:<span class="cm-variable">train</span>(<span class="cm-variable">trainset</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- this is such a small dataset you wont notice much difference on speedup</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 59px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 29px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 18.1816px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### To try another dataset with a simple script ...</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 29px;"></div><div class="CodeMirror-gutters" style="display: none; height: 45px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="To-try-another-dataset-with-a-simple-script-...">To try another dataset with a simple script ...<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#To-try-another-dataset-with-a-simple-script-..."></a></h3>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 93px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3643px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Clement Farabet of Twitter lets you run a full network here on Google Street View House Numbers dataset. Due to time we've set the -size flag to small (uses 10,000 training images only of the 73,000+)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-tag">![]</span><span class="cm-string">(images/SVHN.jpg)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> </span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 93px;"></div><div class="CodeMirror-gutters" style="display: none; height: 108px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Clement Farabet of Twitter lets you run a full network here on Google Street View House Numbers dataset. Due to time we've set the -size flag to small (uses 10,000 training images only of the 73,000+)</p>
<p> <img src="./Getting started with Torch7_files/SVHN.jpg" alt=""></p>
</div></div></div><div class="cell code_cell rendered running unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 103.776px; left: 174.687px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 572.588px; margin-bottom: -15px; border-right-width: 15px; min-height: 1042px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 169.091px; top: 98.1797px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- This script loads the (SVHN) House Numbers dataset</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- http://ufldl.stanford.edu/housenumbers/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- Note: files were converted from their original Matlab format</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- to Torch's internal format using the mattorch package. The</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- mattorch package allows 1-to-1 conversion between Torch and Matlab</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- files.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- The SVHN dataset contains 3 files:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--    + train: training data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--    + test:  test data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--    + extra: extra training data</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">train_file</span> = <span class="cm-string">'/home/ubuntu/data/svhn/housenumbers/train_32x32.t7'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">test_file</span> = <span class="cm-string">'/home/ubuntu/data/svhn/housenumbers/test_32x32.t7'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">extra_file</span> = <span class="cm-string">'/home/ubuntu/data/svhn/housenumbers/extra_32x32.t7'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> <span class="cm-string">'==&gt; loading dataset'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- We load the dataset from disk, and re-arrange it to be compatible</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- with Torch's representation. Matlab uses a column-major representation,</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- Torch is row-major, so we just have to transpose the data.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- Note: the data, in X, is 4-d: the 1st dim indexes the samples, the 2nd</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- dim indexes the color channels (RGB), and the last two dims index the</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- height and width of the samples.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">loaded</span> = <span class="cm-variable">torch.load</span>(<span class="cm-variable">train_file</span>,<span class="cm-string">'ascii'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">trainData</span> = {</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">data</span> = <span class="cm-variable">loaded.X</span>:<span class="cm-variable">transpose</span>(<span class="cm-number">3</span>,<span class="cm-number">4</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">labels</span> = <span class="cm-variable">loaded.y</span>[<span class="cm-number">1</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">size</span> = <span class="cm-keyword">function</span>() <span class="cm-keyword">return</span> <span class="cm-variable">trsize</span> <span class="cm-keyword">end</span></span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">loaded</span> = <span class="cm-variable">torch.load</span>(<span class="cm-variable">extra_file</span>,<span class="cm-string">'ascii'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">extraTrainData</span> = {</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">data</span> = <span class="cm-variable">loaded.X</span>:<span class="cm-variable">transpose</span>(<span class="cm-number">3</span>,<span class="cm-number">4</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">labels</span> = <span class="cm-variable">loaded.y</span>[<span class="cm-number">1</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">size</span> = <span class="cm-keyword">function</span>() <span class="cm-keyword">return</span> <span class="cm-variable">trsize</span> <span class="cm-keyword">end</span></span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">loaded</span> = <span class="cm-variable">torch.load</span>(<span class="cm-variable">test_file</span>,<span class="cm-string">'ascii'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">testData</span> = {</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">data</span> = <span class="cm-variable">loaded.X</span>:<span class="cm-variable">transpose</span>(<span class="cm-number">3</span>,<span class="cm-number">4</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">labels</span> = <span class="cm-variable">loaded.y</span>[<span class="cm-number">1</span>],</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">size</span> = <span class="cm-keyword">function</span>() <span class="cm-keyword">return</span> <span class="cm-variable">tesize</span> <span class="cm-keyword">end</span></span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> <span class="cm-string">'==&gt; visualizing data'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- Visualization is quite easy, using itorch.image().</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">itorch</span> <span class="cm-keyword">then</span></span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-builtin">print</span>(<span class="cm-string">'training data:'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">itorch.image</span>(<span class="cm-variable">trainData.data</span>[{ {<span class="cm-number">1</span>,<span class="cm-number">128</span>} }])</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-builtin">print</span>(<span class="cm-string">'extra training data:'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">itorch.image</span>(<span class="cm-variable">extraTrainData.data</span>[{ {<span class="cm-number">1</span>,<span class="cm-number">128</span>} }])</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-builtin">print</span>(<span class="cm-string">'test data:'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">itorch.image</span>(<span class="cm-variable">testData.data</span>[{ {<span class="cm-number">1</span>,<span class="cm-number">128</span>} }])</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 1042px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1057px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered selected running" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[*]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 71.0497px; left: 143.778px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 657.176px; margin-bottom: -15px; border-right-width: 15px; min-height: 1304px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 138.182px; top: 65.4531px; height: 16.3636px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- This tutorial shows how to train different models on the street</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- view house number dataset (SVHN),</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- using multiple optimization techniques (SGD, ASGD, CG), and</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- multiple types of models.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- This script demonstrates a classical example of training </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- well-known models (convnet, MLP, logistic regression)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- on a 10-class classification problem. </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- It illustrates several points:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- 1/ description of the model</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- 2/ choice of a loss function (criterion) to minimize</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- 3/ creation of a dataset as a simple Lua table</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- 4/ description of training and test procedures</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- Clement Farabet</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">require</span> <span class="cm-string">'torch'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> <span class="cm-string">'==&gt; processing options'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span> = <span class="cm-variable">torch.CmdLine</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">text</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">text</span>(<span class="cm-string">'SVHN Loss Function'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">text</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">text</span>(<span class="cm-string">'Options:'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- global:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-seed'</span>, <span class="cm-number">1</span>, <span class="cm-string">'fixed input seed for repeatable experiments'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-threads'</span>, <span class="cm-number">2</span>, <span class="cm-string">'number of threads'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- data:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-size'</span>, <span class="cm-string">'small'</span>, <span class="cm-string">'how many samples do we load: small | full | extra'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- model:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-model'</span>, <span class="cm-string">'convnet'</span>, <span class="cm-string">'type of model to construct: linear | mlp | convnet'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- loss:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-loss'</span>, <span class="cm-string">'nll'</span>, <span class="cm-string">'type of loss function to minimize: nll | mse | margin'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- training:</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-save'</span>, <span class="cm-string">'results'</span>, <span class="cm-string">'subdirectory to save/log experiments in'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-plot'</span>, <span class="cm-keyword">false</span>, <span class="cm-string">'live plot'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-optimization'</span>, <span class="cm-string">'SGD'</span>, <span class="cm-string">'optimization method: SGD | ASGD | CG | LBFGS'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-learningRate'</span>, <span class="cm-number">1e</span>-<span class="cm-number">3</span>, <span class="cm-string">'learning rate at t=0'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-batchSize'</span>, <span class="cm-number">1</span>, <span class="cm-string">'mini-batch size (1 = pure stochastic)'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-weightDecay'</span>, <span class="cm-number">0</span>, <span class="cm-string">'weight decay (SGD only)'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-momentum'</span>, <span class="cm-number">0</span>, <span class="cm-string">'momentum (SGD only)'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-t0'</span>, <span class="cm-number">1</span>, <span class="cm-string">'start averaging at t0 (ASGD only), in nb of epochs'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-maxIter'</span>, <span class="cm-number">2</span>, <span class="cm-string">'maximum nb of iterations for CG and LBFGS'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">option</span>(<span class="cm-string">'-type'</span>, <span class="cm-string">'double'</span>, <span class="cm-string">'type: double | float | cuda'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">cmd</span>:<span class="cm-variable">text</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">opt</span> = <span class="cm-variable">cmd</span>:<span class="cm-variable">parse</span>(<span class="cm-variable">arg</span> <span class="cm-keyword">or</span> {})</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">-- nb of threads and fixed seed (for repeatable experiments)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">opt.type</span> == <span class="cm-string">'float'</span> <span class="cm-keyword">then</span></span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-builtin">print</span>(<span class="cm-string">'==&gt; switching to floats'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">torch.setdefaulttensortype</span>(<span class="cm-string">'torch.FloatTensor'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">elseif</span> <span class="cm-variable">opt.type</span> == <span class="cm-string">'cuda'</span> <span class="cm-keyword">then</span></span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-builtin">print</span>(<span class="cm-string">'==&gt; switching to CUDA'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-builtin">require</span> <span class="cm-string">'cunn'</span></span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">torch.setdefaulttensortype</span>(<span class="cm-string">'torch.FloatTensor'</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">torch.setnumthreads</span>(<span class="cm-variable">opt.threads</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">torch.manualSeed</span>(<span class="cm-variable">opt.seed</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> <span class="cm-string">'==&gt; executing all'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">dofile</span> <span class="cm-string">'/home/ubuntu/data/svhn/1_data.lua'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">dofile</span> <span class="cm-string">'/home/ubuntu/data/svhn/2_model.lua'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">dofile</span> <span class="cm-string">'/home/ubuntu/data/svhn/3_loss.lua'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">dofile</span> <span class="cm-string">'/home/ubuntu/data/svhn/4_train.lua'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">dofile</span> <span class="cm-string">'/home/ubuntu/data/svhn/5_test.lua'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">----------------------------------------------------------------------</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-builtin">print</span> <span class="cm-string">'==&gt; training!'</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">while</span> <span class="cm-keyword">true</span> <span class="cm-keyword">do</span></span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">train</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;">   <span class="cm-variable">test</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">end</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 1304px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1319px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 93px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">Our developers are working hard to offer full integration on DIGITS, our deep learning GPU training system and will be releasing a beta shortly. Here is the output of training Lenet on MNIST using Torch - the screen shots looks very much like Caffe but this is raw Torch output.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">![]</span><span class="cm-string">(images/digits.jpg)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 93px;"></div><div class="CodeMirror-gutters" style="display: none; height: 108px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Our developers are working hard to offer full integration on DIGITS, our deep learning GPU training system and will be releasing a beta shortly. Here is the output of training Lenet on MNIST using Torch - the screen shots looks very much like Caffe but this is raw Torch output.</p>
<p><img src="./Getting started with Torch7_files/digits.jpg" alt=""></p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 670px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0918px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Post-Lab Summary</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">If you would like to download this lab for later viewing, please go to <span class="cm-strong">**your browsers File menu**</span> (not the Jupyter notebook file menu) and save the complete web page.  This will ensure the images are copied down as well.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Torch is maintained by the deep learning field's top coders and this lab is thanks to them. They are all very happy to offer this assistance because they want you using their highly optimized framework, <span class="cm-strong">**Torch7**</span>. </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">The Cheatsheet <span class="cm-link">https://github.com/torch/torch7/wiki/Cheatsheet</span> and all code are maintained on Github <span class="cm-link">https://github.com/torch/torch7</span> but if you do have <span class="cm-strong">**advanced questions ONLY**</span> you can head over to Gitter where most devs hang out, but PLEASE - for install or newbie questions go to the Google Group first for very quick responses.</span></pre><pre class=""><span style="padding-right: 0.1px;">* Ask for help: <span class="cm-link">http://groups.google.com/forum/#!forum/torch7</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* Chat with developers of Torch: <span class="cm-link">http://gitter.im/torch/torch7</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### More information</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">iTorch is simply an iPython kernel for Torch allowing images, video etc and you can use it outside of this lab instance via <span class="cm-link">https://github.com/facebook/iTorch#requirements</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For more advanced coding you need to download and try Torch yourself. Torch is open-source, so you can also start with the code on the GitHub repo <span class="cm-link">https://github.com/torch/torch7</span> and use the Getting Started guide here <span class="cm-link">http://torch.ch/docs/getting-started.html</span>. You can learn more about LuaJIT here <span class="cm-link">http://luajit.org/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Build crazy graphs of networks: </span><span class="cm-variable-2 cm-link">https://github.com/torch/nngraph</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Train on imagenet with multiple GPUs: </span><span class="cm-variable-2 cm-link">https://github.com/soumith/imagenet-multiGPU.torch</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* Train recurrent networks with LSTM on text: </span><span class="cm-variable-2 cm-link">https://github.com/wojzaremba/lstm</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-2">* More demos and tutorials: </span><span class="cm-variable-2 cm-link">https://github.com/torch/torch7/wiki/Cheatsheet</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Due to Torch's embeddable nature it can even be run on our NVIDIA Jetson TK1 boards.</span></pre><pre class=""><span style="padding-right: 0.1px;">Installation and usage instructions for Torch + CuDNN on Jetson TK1 is here:</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-link">https://github.com/e-lab/torch-toolbox/blob/master/Tutorials/Setup-Torch-cuDNN-on-Jetson-TK1.md</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For Matlab users, UCLAs Ata Mahjoubfar, PhD has kindly written a separate very thorough cheatsheet for you here: <span class="cm-link">http://atamahjoubfar.github.io/Torch_for_Matlab_users.pdf</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For Numpy users theres <span class="cm-link">https://github.com/torch/torch7/wiki/Torch-for-Numpy-users</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">For advanced users, please refer to the gotchas here <span class="cm-link">https://luapower.com/luajit-notes</span> </span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 670px;"></div><div class="CodeMirror-gutters" style="display: none; height: 685px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Post-Lab-Summary">Post-Lab Summary<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Post-Lab-Summary"></a></h2>
<p>If you would like to download this lab for later viewing, please go to <strong>your browsers File menu</strong> (not the Jupyter notebook file menu) and save the complete web page.  This will ensure the images are copied down as well.</p>
<p>Torch is maintained by the deep learning field's top coders and this lab is thanks to them. They are all very happy to offer this assistance because they want you using their highly optimized framework, <strong>Torch7</strong>. </p>
<p>The Cheatsheet <a href="https://github.com/torch/torch7/wiki/Cheatsheet" target="_blank">https://github.com/torch/torch7/wiki/Cheatsheet</a> and all code are maintained on Github <a href="https://github.com/torch/torch7" target="_blank">https://github.com/torch/torch7</a> but if you do have <strong>advanced questions ONLY</strong> you can head over to Gitter where most devs hang out, but PLEASE - for install or newbie questions go to the Google Group first for very quick responses.</p>
<ul>
<li>Ask for help: <a href="http://groups.google.com/forum/#!forum/torch7" target="_blank">http://groups.google.com/forum/#!forum/torch7</a></li>
<li>Chat with developers of Torch: <a href="http://gitter.im/torch/torch7" target="_blank">http://gitter.im/torch/torch7</a></li>
</ul>
<h3 id="More-information">More information<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#More-information"></a></h3>
<p>iTorch is simply an iPython kernel for Torch allowing images, video etc and you can use it outside of this lab instance via <a href="https://github.com/facebook/iTorch#requirements" target="_blank">https://github.com/facebook/iTorch#requirements</a></p>
<p>For more advanced coding you need to download and try Torch yourself. Torch is open-source, so you can also start with the code on the GitHub repo <a href="https://github.com/torch/torch7" target="_blank">https://github.com/torch/torch7</a> and use the Getting Started guide here <a href="http://torch.ch/docs/getting-started.html" target="_blank">http://torch.ch/docs/getting-started.html</a>. You can learn more about LuaJIT here <a href="http://luajit.org/" target="_blank">http://luajit.org/</a></p>
<ul>
<li>Build crazy graphs of networks: <a href="https://github.com/torch/nngraph" target="_blank">https://github.com/torch/nngraph</a></li>
<li>Train on imagenet with multiple GPUs: <a href="https://github.com/soumith/imagenet-multiGPU.torch" target="_blank">https://github.com/soumith/imagenet-multiGPU.torch</a></li>
<li>Train recurrent networks with LSTM on text: <a href="https://github.com/wojzaremba/lstm" target="_blank">https://github.com/wojzaremba/lstm</a></li>
<li>More demos and tutorials: <a href="https://github.com/torch/torch7/wiki/Cheatsheet" target="_blank">https://github.com/torch/torch7/wiki/Cheatsheet</a></li>
</ul>
<p>Due to Torch's embeddable nature it can even be run on our NVIDIA Jetson TK1 boards.
Installation and usage instructions for Torch + CuDNN on Jetson TK1 is here:
<a href="https://github.com/e-lab/torch-toolbox/blob/master/Tutorials/Setup-Torch-cuDNN-on-Jetson-TK1.md" target="_blank">https://github.com/e-lab/torch-toolbox/blob/master/Tutorials/Setup-Torch-cuDNN-on-Jetson-TK1.md</a> </p>
<p>For Matlab users, UCLAs Ata Mahjoubfar, PhD has kindly written a separate very thorough cheatsheet for you here: <a href="http://atamahjoubfar.github.io/Torch_for_Matlab_users.pdf" target="_blank">http://atamahjoubfar.github.io/Torch_for_Matlab_users.pdf</a></p>
<p>For Numpy users theres <a href="https://github.com/torch/torch7/wiki/Torch-for-Numpy-users" target="_blank">https://github.com/torch/torch7/wiki/Torch-for-Numpy-users</a></p>
<p>For advanced users, please refer to the gotchas here <a href="https://luapower.com/luajit-notes" target="_blank">https://luapower.com/luajit-notes</a> </p>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59766px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 342px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;">To learn more about these other topics, please visit:</span></pre><pre class=""><span style="padding-right: 0.1px;">* GPU accelerated machine learning: <span class="cm-link">[</span><span class="cm-link cm-link">http://www.nvidia.com/object/machine-learning.html]</span><span class="cm-string cm-link">(http://www.nvidia.com/object/machine-learning.html)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* Theano: <span class="cm-link">[</span><span class="cm-link cm-link">http://deeplearning.net/software/theano/]</span><span class="cm-string cm-link">(http://deeplearning.net/software/theano/)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* Torch: <span class="cm-link">[</span><span class="cm-link cm-link">http://torch.ch/]</span><span class="cm-string cm-link">(http://torch.ch/)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* DIGITS: <span class="cm-link">[</span><span class="cm-link cm-link">https://developer.nvidia.com/digits]</span><span class="cm-string cm-link">(https://developer.nvidia.com/digits)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* cuDNN: <span class="cm-link">[</span><span class="cm-link cm-link">https://developer.nvidia.com/cudnn]</span><span class="cm-string cm-link">(https://developer.nvidia.com/cudnn)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Deep Learning Lab Series</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Make sure to check out the rest of the classes in this Deep Learning lab series.  You can find them <span class="cm-link">[here]</span><span class="cm-string">(https://developer.nvidia.com/deep-learning-courses)</span>.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Acknowledgements</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;">Many thanks to </span></pre><pre class=""><span style="padding-right: 0.1px;">* Soumith Chintala of Facebook for his 2015 <span class="cm-strong">**60 minute blitz**</span> on Github <span class="cm-link">https://github.com/soumith/cvpr2015/blob/master/Deep%20Learning%20with%20Torch.ipynb</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* Clement Farabet for his Madbits tutorials here <span class="cm-link">http://code.madbits.com/wiki/doku.php</span></span></pre><pre class=""><span style="padding-right: 0.1px;">* Mark Ebersole and Larry Brown @NVIDIA for their help putting together this lab.</span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 342px;"></div><div class="CodeMirror-gutters" style="display: none; height: 357px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>To learn more about these other topics, please visit:</p>
<ul>
<li>GPU accelerated machine learning: <a href="http://www.nvidia.com/object/machine-learning.html" target="_blank">http://www.nvidia.com/object/machine-learning.html</a></li>
<li>Theano: <a href="http://deeplearning.net/software/theano/" target="_blank">http://deeplearning.net/software/theano/</a></li>
<li>Torch: <a href="http://torch.ch/" target="_blank">http://torch.ch/</a></li>
<li>DIGITS: <a href="https://developer.nvidia.com/digits" target="_blank">https://developer.nvidia.com/digits</a></li>
<li>cuDNN: <a href="https://developer.nvidia.com/cudnn" target="_blank">https://developer.nvidia.com/cudnn</a></li>
</ul>
<h3 id="Deep-Learning-Lab-Series">Deep Learning Lab Series<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Deep-Learning-Lab-Series"></a></h3>
<p>Make sure to check out the rest of the classes in this Deep Learning lab series.  You can find them <a href="https://developer.nvidia.com/deep-learning-courses" target="_blank">here</a>.</p>
<h3 id="Acknowledgements">Acknowledgements<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Acknowledgements"></a></h3>
<p>Many thanks to </p>
<ul>
<li>Soumith Chintala of Facebook for his 2015 <strong>60 minute blitz</strong> on Github <a href="https://github.com/soumith/cvpr2015/blob/master/Deep%20Learning%20with%20Torch.ipynb" target="_blank">https://github.com/soumith/cvpr2015/blob/master/Deep%20Learning%20with%20Torch.ipynb</a></li>
<li>Clement Farabet for his Madbits tutorials here <a href="http://code.madbits.com/wiki/doku.php" target="_blank">http://code.madbits.com/wiki/doku.php</a></li>
<li>Mark Ebersole and Larry Brown @NVIDIA for their help putting together this lab.</li>
</ul>
</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.5957px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 65px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 19.0918px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Answers</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span></span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Task </span><span class="cm-header cm-header-3 cm-link">#1</span><span class="cm-header cm-header-3"> Answer</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 65px;"></div><div class="CodeMirror-gutters" style="display: none; height: 80px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Answers">Answers<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Answers"></a></h2>
<h3 id="Task-#1-Answer">Task #1 Answer<a class="anchor-link" href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#Task-#1-Answer"></a></h3>
</div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59668px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 957.446px; margin-bottom: -15px; border-right-width: 15px; min-height: 175px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span> = <span class="cm-variable">nn.Sequential</span>()</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">3</span>, <span class="cm-number">6</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>)) <span class="cm-comment">-- 1 input image channel, 6 output channels, 5x5 convolution kernel</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialMaxPooling</span>(<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>))     <span class="cm-comment">-- A max-pooling operation that looks at 2x2 windows and finds the max.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialConvolution</span>(<span class="cm-number">6</span>, <span class="cm-number">16</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.SpatialMaxPooling</span>(<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.View</span>(<span class="cm-number">16</span>*<span class="cm-number">5</span>*<span class="cm-number">5</span>))                    <span class="cm-comment">-- reshapes from a 3D tensor of 16x5x5 into 1D tensor of 16*5*5</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">16</span>*<span class="cm-number">5</span>*<span class="cm-number">5</span>, <span class="cm-number">120</span>))             <span class="cm-comment">-- fully connected layer (matrix multiplication between input and weights)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">120</span>, <span class="cm-number">84</span>))</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.Linear</span>(<span class="cm-number">84</span>, <span class="cm-number">10</span>))                   <span class="cm-comment">-- 10 is the number of outputs of the network (in this case, 10 digits)</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">net</span>:<span class="cm-variable">add</span>(<span class="cm-variable">nn.LogSoftMax</span>())                     <span class="cm-comment">-- converts the output to a log-probability. Useful for classification problems</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 175px;"></div><div class="CodeMirror-gutters" style="display: none; height: 190px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close"></button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to expand output; double click to hide output" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.5957px; left: 5.59659px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" not-content="true"></div><div class="CodeMirror-gutter-filler" not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -15px; border-right-width: 15px; min-height: 27px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 16.3633px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-link">[Return to Task </span><span class="cm-link cm-link">#1</span><span class="cm-link">]</span><span class="cm-string">(#Task-1:)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 43px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p><a href="./Getting started with Torch7_files/Getting started with Torch7.html">Return to Task #1</a></p>
</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="http://ec2-54-226-84-67.compute-1.amazonaws.com/9hhwyw8mMT9B/notebooks/Getting%20started%20with%20Torch7.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"os_name": "posix", "sys_version": "2.7.6 (default, Jun 22 2015, 17:58:13) \n[GCC 4.8.2]", "default_encoding": "ANSI_X3.4-1968", "sys_platform": "linux2", "ipython_version": "3.2.1", "ipython_path": "/usr/local/lib/python2.7/dist-packages/IPython", "commit_source": "installation", "platform": "Linux-3.13.0-46-generic-x86_64-with-Ubuntu-14.04-trusty", "sys_executable": "/usr/bin/python", "commit_hash": "2d95975"};
</script>

<script src="./Getting started with Torch7_files/encoding.js" charset="utf-8"></script>

<script src="./Getting started with Torch7_files/main.js" charset="utf-8"></script>





<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main, sans-serif;"></div></div></body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>